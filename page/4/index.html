<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  

  
  <title>Hexo</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta property="og:type" content="website">
<meta property="og:title" content="Hexo">
<meta property="og:url" content="http://yoursite.com/page/4/index.html">
<meta property="og:site_name" content="Hexo">
<meta property="og:locale" content="default">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Hexo">
  
    <link rel="alternate" href="/atom.xml" title="Hexo" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
</head>

<body>
  <div id="container">
    <div id="wrap">
      <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">Hexo</a>
      </h1>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="http://yoursite.com"></form>
      </div>
    </div>
  </div>
</header>
      <div class="outer">
        <section id="main">
  
    <article id="post-kpartx-a-common-partition-in-a-virtual-machine-image-file" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/09/07/kpartx-a-common-partition-in-a-virtual-machine-image-file/" class="article-date">
  <time datetime="2011-09-07T06:53:17.000Z" itemprop="datePublished">2011-09-07</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/默认分类/">默认分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2011/09/07/kpartx-a-common-partition-in-a-virtual-machine-image-file/">kpartx--挂载虚拟机镜像文件里的普通分区</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>用 virt-manager, virsh 或其他工具可以选择把 KVM 或 Xen HVM 的虚拟机安装在一个镜像文件上，虽然因为性能的关系这种方式不推荐在生产环境使用，但是因为用起来非常简便，所以 VPSee 平时做实验或测试的时候会经常用这种方式存储虚拟机。上星期提到了 “<a href="http://www.vpsee.com/2010/10/mount-lvm-volumes-from-loopback-disk-images/" target="_blank" rel="noopener">挂载虚拟机镜像文件里的 LVM 逻辑分区</a>”，那么如何挂载虚拟机镜像文件里的普通分区呢？这比挂载 LVM 逻辑分区要简单多了，不用算那个地址偏移量 offset，也不用 LVM 打交道。</p>
<p>和以前一样，首先用 losetup 工具把 centos.img 文件和 loop 设备映射起来，-f 参数用来找出下一个可用的 loop 设备：</p>
<p># losetup -f /dev/loop0  # losetup /dev/loop0 /home/vpsee/centos.img </p>
<p>一个镜像文件里可能包含多个分区，所以不能简单 mount -o loop centos.img，我们需要把 centos.img 里面包含的每个分区映射出来后在一个一个挂载，所以需要一个工具来读分区表，kpartx 就是这样一个在特定设备上读取分区表并为每个分区创建映射的工具，-a 参数表示加入分区映射；-v 参数表示完成后输出结果：</p>
<p># kpartx -av /dev/loop0 add map loop0p1 : 0 208782 linear /dev/loop0 63 add map loop0p2 : 0 1044225 linear /dev/loop0 208845 add map loop0p3 : 0 19711755 linear /dev/loop0 1253070 </p>
<p>上面 loop0p1, loop0p2, loop0p3 分别映射到镜像文件里的3个分区里，可以通过 fdisk 来查看：</p>
<p># fdisk -l /dev/loop0  Disk /dev/loop0: 10.7 GB, 10737418240 bytes 255 heads, 63 sectors/track, 1305 cylinders Units = cylinders of 16065 <em> 512 = 8225280 bytes        Device Boot      Start         End      Blocks   Id  System /dev/loop0p1   </em>           1          13      104391   83  Linux /dev/loop0p2              14          78      522112+  82  Linux swap / Solaris /dev/loop0p3              79        1305     9855877+  83  Linux </p>
<p>有了上面的映射以后就可以挂载 centos.img 里的普通逻辑分区了，我们这里只挂载 root 分区，root 分区在 loop0p3，挂载成功后用 ls 查看一下是否正确：</p>
<p># ls -l /dev/mapper/ total 0 crw——- 1 root root  10, 63 Sep 24 11:34 control brw-r—– 1 root disk 253,  2 Oct 14 19:55 loop0p1 brw-r—– 1 root disk 253,  3 Oct 14 19:55 loop0p2 brw-r—– 1 root disk 253,  4 Oct 14 19:55 loop0p3  # mount /dev/mapper/loop0p3 /mnt # ls /mnt bin   dev  home  lib64       media  opt   root  selinux  sys  usr boot  etc  lib   lost+found  mnt    proc  sbin  srv      tmp  var </p>
<p>使用完后，需要按顺序干净卸载：</p>
<p># umount /mnt  # kpartx -dv /dev/loop0 del devmap : loop0p1 del devmap : loop0p2 del devmap : loop0p3  # losetup -d /dev/loop0</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2011/09/07/kpartx-a-common-partition-in-a-virtual-machine-image-file/" data-id="cji00lkew007shnzs6bo111vm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-the-setting-of-kvm-bridge-in-centos" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/09/05/the-setting-of-kvm-bridge-in-centos/" class="article-date">
  <time datetime="2011-09-05T09:57:27.000Z" itemprop="datePublished">2011-09-05</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/默认分类/">默认分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2011/09/05/the-setting-of-kvm-bridge-in-centos/">centos中kvm网桥的设置</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>新建一个ifcfg－br0文件：</p>
<p>DEVICE=br0<br>TYPE=Bridge<br>BOOTPROTO=static<br>BROADCAST=10.1.255.255<br>IPADDR=10.1.29.3<br>NETMASK=255.255.0.0<br>NETWORK=10.1.0.0<br>ONBOOT=yes</p>
<p>然后修改相应网卡的配置文件，我的是eth1：</p>
<p># Realtek Semiconductor Co., Ltd. RTL-8169 Gigabit Ethernet<br>DEVICE=eth1  </p>
<p>#BOOTPROTO=none  </p>
<p>#BROADCAST=10.1.255.255<br>HWADDR=D8:5D:4C:74:EE:E8  </p>
<p>#IPADDR=10.1.29.3  </p>
<p>#NETMASK=255.255.0.0  </p>
<p>#NETWORK=10.1.0.0<br>ONBOOT=yes  </p>
<p>#TYPE=Ethernet  </p>
<p>#USERCTL=no  </p>
<p>#IPV6INIT=no  </p>
<p>#PEERDNS=yes<br>BRIDGE=br0</p>
<p>可以看出，原来网卡的配置只保留device名称，硬件地址，onboot选项，以及新添加的BRIDGE=br0。</p>
<p>然后重启网络：</p>
<p>/etc/init.d/network restart 或service network restart</p>
<p>实验中在br0中加入gateway后，/etc/sysconfig/network中的gateway就消失了。成功后，利用route -n查看路由，发现所有的包都从br0走了。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2011/09/05/the-setting-of-kvm-bridge-in-centos/" data-id="cji00lkpj00h4hnzspwgmos10" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-udev-s-plan-for-resolving-multiple-network-cards-to-prevent-sequential-changes-from-restarting" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/09/01/udev-s-plan-for-resolving-multiple-network-cards-to-prevent-sequential-changes-from-restarting/" class="article-date">
  <time datetime="2011-09-01T07:57:24.000Z" itemprop="datePublished">2011-09-01</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2011/09/01/udev-s-plan-for-resolving-multiple-network-cards-to-prevent-sequential-changes-from-restarting/">udev关于解决多网卡，防止重启时顺序改变的方案</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>昨天walfred在群里面，看到了一条“关于机器上面有多网卡，并且做了bond，重启之后却乱序了”的问题，提问的是一名叫Daemon的网友，Daemon之前研究过gentoo，现在貌似转战cent os了，这也是他在搞cent os的时候，遇到的问题，walfred之前只听过cent os,却一直没有接触过，这边就借Daemon的问题记载下这个解决方案。并且也希望自己多和Daemon学习cent os的一些使用技巧。</p>
<p>问题：如标题</p>
<p>这里稍微补充下：如果你有两张网卡，一个是主板上自带的，还有一个是后来自己添加的。装完系统后，系统默认主板上的网卡为eth1，而自己添加的网卡是eth0，所以想办法使用udev使系统将主板上的网卡命名为eth0。</p>
<p>解决方案：</p>
<p>cd /etc/udev/rules.d</p>
<p>找到60-net.rules，备份该文件</p>
<p>mv 60-net.rules 60-net.rules.bak</p>
<p>新建文件60-net.rules，内容如下：</p>
<p>[root@localhost rules.d]# cat 60-net.rules</p>
<p>SUBSYSTEM==”net”, ACTION==”add”, SYSFS{address}==”你自己的网卡1的mac地址”,</p>
<p>IMPORT=”/lib/udev/rename_device %k eth0”</p>
<p>SUBSYSTEM==”net”, ACTION==”add”, SYSFS{address}==”你自己的网卡2的mac地址”,</p>
<p>IMPORT=”/lib/udev/rename_device %k eth1”</p>
<p>其中需要注意的是，你要将你自己的网卡的mac地址做相应的更改。</p>
<p>重启电脑，一切ok。<br>不重启的话比较麻烦一点，下面介绍一下<br>使用udevinfo 获取网卡物理设备信息<br>udevinfo -a -p /sys/class/net/eth0<br>取消mac等信息<br>然后添加规则如：SUBSYSTEM==”net”,SYSFS{address}==”00:11:5b:d1:0e:f8”,NAME=”lan0”<br>注意：在udev规则文件中必须使用小写的16进制MAC地址，udev无法识别大写的MAC地址（或直接以udevinfo 的输出为准）。<br>如果修改了设备名，需要重新启动udev<br>由于需重命名网络设备，故需停止网络，并卸载网卡驱动模块：<br>ervice network stop;rmmod 8139cp;rmmod 8139too;start_udev;service network start<br>若没有停止网络，而该网卡设备仍在使用中，重启udev 服务时，会报错：<br>Sep  1 15:43:57 ax3sp3 udevd-event[3077]: rename_netif: error changing netif name: Device or resource busy</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2011/09/01/udev-s-plan-for-resolving-multiple-network-cards-to-prevent-sequential-changes-from-restarting/" data-id="cji00lkvu00m5hnzsy0yjl0fj" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-rhel5-4-for-chinese-sorting-problem" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/08/30/rhel5-4-for-chinese-sorting-problem/" class="article-date">
  <time datetime="2011-08-30T09:07:04.000Z" itemprop="datePublished">2011-08-30</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/默认分类/">默认分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2011/08/30/rhel5-4-for-chinese-sorting-problem/">RHEL5.4对中文排序问题</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天德哥发现rhel5.4上使用sort对中文进行拼音排序，而在rhel6中是正常的。现象如下：</p>
<p>[root@rhel5-2 ~]# locale</p>
<p>LANG=zh_CN.utf-8</p>
<p>LC_CTYPE=zh_CN.utf-8</p>
<p>LC_NUMERIC=”zh_CN.utf-8”</p>
<p>LC_TIME=”zh_CN.utf-8”</p>
<p>LC_COLLATE=zh_CN.utf-8</p>
<p>LC_MONETARY=”zh_CN.utf-8”</p>
<p>LC_MESSAGES=”zh_CN.utf-8”</p>
<p>LC_PAPER=”zh_CN.utf-8”</p>
<p>LC_NAME=”zh_CN.utf-8”</p>
<p>LC_ADDRESS=”zh_CN.utf-8”</p>
<p>LC_TELEPHONE=”zh_CN.utf-8”</p>
<p>LC_MEASUREMENT=”zh_CN.utf-8”</p>
<p>LC_IDENTIFICATION=”zh_CN.utf-8”</p>
<p>LC_ALL=</p>
<p>[root@rhel5-2 ~]# cat test</p>
<p>中国</p>
<p>日本</p>
<p>美国</p>
<p>上海</p>
<p>[root@rhel5-2 ~]# sort test</p>
<p>上海</p>
<p>中国</p>
<p>日本</p>
<p>美国</p>
<p>[root@rhel5-2 ~]# rpm -qa|grep glibc</p>
<p>glibc-common-2.5-42</p>
<p>glibc-devel-2.5-42</p>
<p>glibc-2.5-42</p>
<p>glibc-headers-2.5-42</p>
<p>这其实是因为中文本地化数据并没有包含拼音排序的信息。即glibc中的local数据不包含对中文按拼音和笔画的排序</p>
<p>官方上bug的提交如下：</p>
<p><a href="http://sources.redhat.com/ml/glibc-bugs/2007-02/msg00068.html" target="_blank" rel="noopener">http://sources.redhat.com/ml/glibc-bugs/2007-02/msg00068.html</a></p>
<p><a href="http://sourceware.org/bugzilla/show_bug.cgi?id=4024" target="_blank" rel="noopener">http://sourceware.org/bugzilla/show_bug.cgi?id=4024</a></p>
<p>现在给出解决方案，如下：</p>
<p>现在通过安装一种额外的中文本地化数据zh_CN@pinyin就可以让你在UTF-8和GB18030字符集下都可以正确的排序中文。 即locale-pinyin</p>
<p>介绍</p>
<p>＝＝</p>
<p>按拼音排序的中文locale。</p>
<p>在类Unix中为了能够正确的排序电脑中的中文，你必须有能够正确对中文进行排序</p>
<p>的locale数据。而glibc包含的locale数据一直没能对中文按照拼音或者笔画排</p>
<p>序。本软件则是为你在电脑中增加一种按照拼音排序的中文locale。</p>
<p>安装</p>
<p>＝＝</p>
<p>系统需求：</p>
<p>1、系统需要有符合X/Open标准的localedef工具</p>
<p>2、5.8.1以上的perl</p>
<p>安装：</p>
<p>$make</p>
<p>#make install</p>
<p>配置</p>
<p>＝＝</p>
<p>为了生效，你必须正确配置locale环境变量。</p>
<p>推荐仅设置LC_COLLATE为本locale，比如：</p>
<p>LANG=zh_CN.UTF-8</p>
<p>LC_COLLATE=zh_<a href="mailto:CN@pinyin.utf8" target="_blank" rel="noopener">CN@pinyin.utf8</a></p>
<p>注意：不要同时设置LC_ALL和LC_COLLATE，这样可能会导致本locale不能正确生</p>
<p>效。</p>
<p>再跟踪glibc，发现官方在比较新的版本中已经把local_pinyin合并进去了(glibc2.6以上)，如下：</p>
<p><a href="http://sourceware.org/cgi-bin/cvsweb.cgi/libc/localedata/locales/iso14651_t1_pinyin?rev=1.1&amp;content-type=text/x-cvsweb-markup&amp;cvsroot=glibc" target="_blank" rel="noopener">http://sourceware.org/cgi-bin/cvsweb.cgi/libc/localedata/locales/iso14651_t1_pinyin?rev=1.1&amp;content-type=text/x-cvsweb-markup&amp;cvsroot=glibc</a></p>
<p>升级glibc是一个比较大的工程，涉及也比较广，建议在用rhel5时先打上local_pinyin补丁，或者可以考虑使用rhel6</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2011/08/30/rhel5-4-for-chinese-sorting-problem/" data-id="cji00lkl400dahnzs09gx01l2" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-cacti-monitors-tcp-connection-number-and-solves-ipv6-problem" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/08/17/cacti-monitors-tcp-connection-number-and-solves-ipv6-problem/" class="article-date">
  <time datetime="2011-08-17T06:06:12.000Z" itemprop="datePublished">2011-08-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/默认分类/">默认分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2011/08/17/cacti-monitors-tcp-connection-number-and-solves-ipv6-problem/">cacti 监控tcp连接数，ipv6问题解决</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>原文为<a href="http://xok.la/2010/04/cacti_netstat_tcp.html" target="_blank" rel="noopener">http://xok.la/2010/04/cacti_netstat_tcp.html</a>，是通过snmpnetstat去拿回来的数据再做处理的，但问题就来了，snmpnetstat 拿到的数据只有ipv4的连接，ipv6的连接全部都没有拿过来。差别还很大。</p>
<p>google了好久，也查了不少资料，但还是没有解决，最后只好去查看net-snmp的文档，<a href="http://net-snmp.sourceforge.net/docs/" target="_blank" rel="noopener">http://net-snmp.sourceforge.net/docs/</a>查看oid，最后查看可以使用.1.3.6.1.2.1.6.19这一个oid获取到数据，再对数据做统计修改脚本，基本实现了tcp的监控问题。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2011/08/17/cacti-monitors-tcp-connection-number-and-solves-ipv6-problem/" data-id="cji00lk8k002bhnzs43d7hjbl" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-sharing-session-memcached-session-the-manager" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/08/17/sharing-session-memcached-session-the-manager/" class="article-date">
  <time datetime="2011-08-17T01:51:36.000Z" itemprop="datePublished">2011-08-17</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/默认分类/">默认分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2011/08/17/sharing-session-memcached-session-the-manager/">共享session,memcached-session-manager</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>1.memcached-2.5.jar,memcached-session-manager-XXX.jar    </p>
<p><a href="http://code.google.com/p/memcached-session-manager/" target="_blank" rel="noopener">http://code.google.com/p/memcached-session-manager/</a></p>
<p><a href="http://code.google.com/p/spymemcached/" target="_blank" rel="noopener">http://code.google.com/p/spymemcached/</a></p>
<p>将附件中的两个包放入tomcat的lib 目录下</p>
<p>用新版本的测试还有点问题java.lang.IllegalArgumentException: No node found for key bak，使用原来的1.4的版本正常  </p>
<ol start="2">
<li><p>修改tomcat的server.xml配置（在Host节点之间添加如下配置）：  </p>
<pre><code>&lt;Context path=&quot;&quot; docBase=&quot;/app/wap/server/sns&quot;&gt;  
         &lt;Manager className=&quot;de.javakaffee.web.msm.MemcachedBackupSessionManager&quot;  
         memcachedNodes=&quot;n1:192.168.169.47:11212 n2:192.168.169.47:11213&quot;  
         failoverNodes=&quot;n2&quot;   
         sticky=&quot;false&quot;   
         requestUriIgnorePattern=&quot;.*\\.(png|gif|jpg|css|js)$&quot;  
         transcoderFactoryClass=&quot;de.javakaffee.web.msm.JavaSerializationTranscoderFactory&quot; /&gt;  
&lt;/Context&gt;
</code></pre></li>
</ol>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2011/08/17/sharing-session-memcached-session-the-manager/" data-id="cji00lklq00dvhnzscntpjl66" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-ext3-ext4-file-system-large-partition-support" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/08/15/ext3-ext4-file-system-large-partition-support/" class="article-date">
  <time datetime="2011-08-15T08:51:04.000Z" itemprop="datePublished">2011-08-15</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/默认分类/">默认分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2011/08/15/ext3-ext4-file-system-large-partition-support/">(转)ext3/ext4文件系统大分区支持</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>很长一段时间以来，ext3是很多linux发行版默认的文件系统，目前ext4已经正式发布，已经有发行版开始使用ext4作为默认的文件系统了，其实最初的时候ext4是作为ext3的扩展，但是为了保证ext3的稳定性等原因，很多人反对直接对ext3进行扩展，所以单独作为了ext4项目。</p>
<pre><code>ext3还是使用15个inode来查找数据块，前12个为直接数据块，直接指向存储数据的数据块，接下来分别为一级间接块，二级间接块，三级间接块，跟下图一致：  
</code></pre><p><img src="http://img.blog.163.com/photo/sKMI40PlO7t27_CM0STucw==/5761792773267886366.jpg" alt="ext3/ext4文件系统大分区支持 - zhuzhu - 五事九思" title="(转)ext3/ext4文件系统大分区支持 - suchalin - 态度决定高度"><br>其中point本来也是数据块，现在拿来做数据块的索引用，其中ext3的头文件定义为： __u32 i_block[EXT3_N_BLOCKS];/<em> Pointers to blocks </em>/，所以可以计算ext3文件系统的极限：<br>最大分区：<br>         因为定义的是无符号32位数，所以可能定位的block范围为2^32，也就是4G，如果一个block大小为4KB，所以为4G <em> 4KB = 16TB<br>最大文件：<br>         前面直接指向12个数据块，一级间接块最大为block size / 4，block size就是数据块的大小，因为一个索引是4个字节，所以除以4，这样计算下来，最大的文件可以使用的总块数为:12 + (block size/4) + (block size/4)^2 + (block size/4)^3，如果block size大小为4K，则为(12 + 2^10 + 2^20 + 2^30) </em> 2^12 约等于4T。</p>
<pre><code>为了突破ext3这个大小限制，ext4使用了48位的数据块索引空间，同时使用了如下结构代替inode索引的方式：  
</code></pre><p>struct ext3_extent {<br>__u32 ee_block; /<em> first logical block extent covers </em>/<br>__u16 ee_len;   /<em> number of blocks covered by extent </em>/<br>__u16 ee_start_hi; /<em> high 16 bits of physical block </em>/<br>__u32 ee_start; /<em> low 32 bigs of physical block </em>/<br>};<br>这样查找数据块的时候就不是每个块建立一个索引，而且使用连续的数据块，也就是分别指示起始位置，以及连续的块数，这样在大文件的时候，磁盘io效率以及查找数据块效率上都有很大的提高，所以ext4的文件系统也比ext3出色。因为使用了48位的索引空间，所以在4KB块大小的情况下，文件系统的极限是2^48 * 4KB = 1EB，不过，目前由于工具的限制，只能使用16TB的分区。</p>
<p>不过是自己的理解，也欢迎朋友指正。</p>
<p>硬盘驱动器上的空间划分（或者说分区）为多个分区。分区不能重叠，未分配给分区的空间称为剩余空间。分区名的形式类似于 /dev/hda1、/dev/hda2、/dev/hda3、/dev/sda1 等。在未使用 IDE 驱动器热插拔支持的系统上，IDE 驱动器最多支持 63 个分区。通过热插拔支持的 SCSI 驱动器、USB 驱动器和 IDE 驱动器最多可有 15 个分区。一个分区通常会分配为整数个柱面（柱面概念可能存在不准确之处）。</p>
<p><a href="http://www.ibm.com/developerworks/cn/linux/l-lpic1-v3-102-1/?S_TACT=105AGX52&amp;S_CMP=tec-ccid" target="_blank" rel="noopener">http://www.ibm.com/developerworks/cn/linux/l-lpic1-v3-102-1/?S_TACT=105AGX52&amp;S_CMP=tec-ccid</a></p>
<p>EXT3与EXT4的主要区别  </p>
<p>Linux kernel 自 2.6.28 开始正式支持新的文件系统 Ext4。 Ext4 是 Ext3 的改进版，修改了 Ext3 中部分重要的数据结构，而不仅仅像 Ext3 对 Ext2 那样，只是增加了一个日志功能而已。Ext4 可以提供更佳的性能和可靠性，还有更为丰富的功能：</p>
<p>1. 与 Ext3 兼容。 执行若干条命令，就能从 Ext3 在线迁移到 Ext4，而无须重新格式化磁盘或重新安装系统。原有 Ext3 数据结构照样保留，Ext4 作用于新数据，当然，整个文件系统因此也就获得了 Ext4 所支持的更大容量。</p>
<p>2. 更大的文件系统和更大的文件。 较之 Ext3 目前所支持的最大 16TB 文件系统和最大 2TB 文件，Ext4 分别支持 1EB（1,048,576TB， 1EB=1024PB， 1PB=1024TB）的文件系统，以及 16TB 的文件。<br>3. 无限数量的子目录。 Ext3 目前只支持 32,000 个子目录，而 Ext4 支持无限数量的子目录。</p>
<p>4. Extents。 Ext3 采用间接块映射，当操作大文件时，效率极其低下。比如一个 100MB 大小的文件，在 Ext3 中要建立 25,600 个数据块（每个数据块大小为 4KB）的映射表。而 Ext4 引入了现代文件系统中流行的 extents 概念，每个 extent 为一组连续的数据块，上述文件则表示为“该文件数据保存在接下来的 25,600 个数据块中”，提高了不少效率。</p>
<p>5. 多块分配。 当 写入数据到 Ext3 文件系统中时，Ext3 的数据块分配器每次只能分配一个 4KB 的块，写一个 100MB 文件就要调用 25,600 次数据块分配器，而 Ext4 的多块分配器“multiblock allocator”（mballoc） 支持一次调用分配多个数据块。</p>
<p>6. 延迟分配。 Ext3 的数据块分配策略是尽快分配，而 Ext4 和其它现代文件操作系统的策略是尽可能地延迟分配，直到文件在 cache 中写完才开始分配数据块并写入磁盘，这样就能优化整个文件的数据块分配，与前两种特性搭配起来可以显著提升性能。</p>
<p>7. 快速 fsck。 以前执行 fsck 第一步就会很慢，因为它要检查所有的 inode，现在 Ext4 给每个组的 inode 表中都添加了一份未使用 inode 的列表，今后 fsck Ext4 文件系统就可以跳过它们而只去检查那些在用的 inode 了。</p>
<p>8. 日志校验。 日志是最常用的部分，也极易导致磁盘硬件故障，而从损坏的日志中恢复数据会导致更多的数据损坏。Ext4 的日志校验功能可以很方便地判断日志数据是否损坏，而且它将 Ext3 的两阶段日志机制合并成一个阶段，在增加安全性的同时提高了性能。</p>
<p>9. “无日志”（No Journaling）模式。 日志总归有一些开销，Ext4 允许关闭日志，以便某些有特殊需求的用户可以借此提升性能。</p>
<p>10. 在线碎片整理。 尽管延迟分配、多块分配和 extents 能有效减少文件系统碎片，但碎片还是不可避免会产生。Ext4 支持在线碎片整理，并将提供 e4defrag 工具进行个别文件或整个文件系统的碎片整理。</p>
<p>11. inode 相关特性。 Ext4 支持更大的 inode，较之 Ext3 默认的 inode 大小 128 字节，Ext4 为了在 inode 中容纳更多的扩展属性（如纳秒时间戳或 inode 版本），默认 inode 大小为 256 字节。Ext4 还支持快速扩展属性（fast extended attributes）和 inode 保留（inodes reservation）。</p>
<p>12. 持久预分配（Persistent preallocation）。 P2P 软件为了保证下载文件有足够的空间存放，常常会预先创建一个与所下载文件大小相同的空文件，以免未来的数小时或数天之内磁盘空间不足导致下载失败。 Ext4 在文件系统层面实现了持久预分配并提供相应的 API（libc 中的 posix_fallocate()），比应用软件自己实现更有效率。</p>
<p>13. 默认启用 barrier。 磁 盘上配有内部缓存，以便重新调整批量数据的写操作顺序，优化写入性能，因此文件系统必须在日志数据写入磁盘之后才能写 commit 记录，若 commit 记录写入在先，而日志有可能损坏，那么就会影响数据完整性。Ext4 默认启用 barrier，只有当 barrier 之前的数据全部写入磁盘，才能写 barrier 之后的数据。（可通过 “mount -o barrier=0″ 命令禁用该特性。）</p>
<p>Ext3 和 ext4 文件系统在线调整大小内幕<br><a href="http://www.ibm.com/developerworks/cn/linux/l-cn-ext4resize/" target="_blank" rel="noopener">http://www.ibm.com/developerworks/cn/linux/l-cn-ext4resize/</a></p>
<p><a href="http://zauc.wordpress.com/2011/02/11/%E5%88%9D%E6%8E%A2ext4%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/" target="_blank" rel="noopener">http://zauc.wordpress.com/2011/02/11/%E5%88%9D%E6%8E%A2ext4%E6%96%87%E4%BB%B6%E7%B3%BB%E7%BB%9F/</a><br> <img src="http://blog.atop.fun/wp-content/uploads/netease/other_site/img229_ph_2141180147839541743.jpg" alt="ext3/ext4文件系统大分区支持 - zhuzhu - 五事九思" title="(转)ext3/ext4文件系统大分区支持 - suchalin - 态度决定高度">  </p>
<p>ext4-howto中文<br><a href="http://zauc.wordpress.com/2011/02/18/ext4-howto%E4%B8%AD%E6%96%87/" target="_blank" rel="noopener">http://zauc.wordpress.com/2011/02/18/ext4-howto%E4%B8%AD%E6%96%87/</a><br><img src="http://blog.atop.fun/wp-content/uploads/netease/other_site/img687_ph_2824882866269436195.png" alt="ext3/ext4文件系统大分区支持 - zhuzhu - 五事九思" title="(转)ext3/ext4文件系统大分区支持 - suchalin - 态度决定高度">  </p>
<p>目前网络中充斥着各种Linux文件系统，用户很难在不了解这么多种文件系统的情况下从中做出一个好的并且适合自己选择，下面的内容转自<a href="http://www.linuxeden.com/" target="_blank" rel="noopener">LinuxEden</a>网站，由于年代久远，原文链接已丢失，并且我在其中加入了EXT4的介绍。熟悉文件系统特性并选择一个合适的文件系统有利于充分利用磁盘物理属性。</p>
<p>1、ext</p>
<p>ext 是第一个专门为 Linux 的文件系统类型,叫做扩展文件系统。它在 1992 年 4 月完成的。它为 Linux 的发展取得了重要作用。但是在性能和兼容性上存在许多缺陷。现在已经很少使用了。</p>
<p>2、ext2</p>
<p>ext2 是为解决 ext 文件系统的缺陷而设计的可扩展的高性能的文件系统。又被称为二级扩展文件系统。它是在 1993 年发布的,设计者是 Rey Card。ext2 是 Linux 文件系统类型中使用最多的格式。并且在速度和 CPU 利用率上较突出,是 GNU/Linux 系统中标准的文件系统,其特点为存取文件的性能极好,对于中小型的文件更显示出优势,这主要得利于其簇快取层的优良设计。2000 年以前几乎所有的 Linux 发行版都用 ext2 作为默认的文件系统。</p>
<p>3、ext3</p>
<p>ext3 是由开放资源社区开发的日志文件系统,主要开发人员是 Stephen tweedie。ext3被设计成是 ext2 的升级版本,尽可能地方便用户从 ext2fs 向 ext3fs 迁移。ext3 在 ext2的基础上加入了记录元数据的日志功能,努力保持向前和向后的兼容性。这个文件系统被称为 ext2 的下一个版本。也就是在保有目前 ext2 的格式之下再加上日志功能。ext3 是一种日志式文件系统。日志式文件系统的优越性在于:由于文件系统都有快取层参与运作,如不使用时必须将文件系统卸下,以便将快取层的资料写回磁盘中。因此每当系统要关机时,必须将其所有的文件系统全部卸下后才能进行关机。如果在文件系统尚未卸下前就关机 (如停电) 时,下次重开机后会造成文件系统的资料不一致,故这时必须做文件系统的重整工作,将不一致与错误的地方修复。</p>
<p>4、ext4</p>
<p>ext4 是一种针对 ext3 系统的扩展日志式文件系统,是 专 门为 Linux 开发的原始的扩展文件系统(ext 或 extfs)的第四版。它 具有更高的兼容性并且消 除了存储限制,从 ext3升级至 ext4 不需要格式化分区。它的子目录具有可伸缩性。ext4 使用了一个多块分配来在一次调用中分配很多块。替换掉每次分配一个块,减少系统开销。在延时分配和 extends 上十分有用。而延迟分配是一个性能特性(它不修改磁盘格式)。相对于传统文件系统(例如ext3、reiser3、etc)所做的立刻分配块提供了更好的性能。</p>
<p>5、JFS</p>
<p>jsf 提供了基于日志的字节级文件系统,该文件系统是为面向事务的高性能系统而开发的。jsf 的开发者包括 AIX 的 jsf 的主要开发者。在 AIX 上,jfs 已经经受住了考验。它是可靠、快速和容易使用的。2000 年 2 月,ibm 宣布在一个开放资源许可证下,移植 linux 版的 JSF 文件系统。 JSFs 也是一个有大量用户安装使用的企业级文件系统。它具有可伸缩性和健壮性,与非日志文件系统相比,它的优点是其快速重启能力:Jfs 能够在几秒或几分钟内就把文件系统恢复到一致状态。虽然 jsf 主要是为满足服务器的高吞吐量和可靠性需求而设计的,jsf 还可用于想得到高性能和可靠性的客户机配置因为在系统崩溃时,jsf 能提供快速文件系统重启时间,所以它是因特网文件服务器的关键技术。使用数据库日志处理技术,jsf 能在几秒或几分钟之内把文件系统恢复到一致状态。而在非日志文件系统中,文件恢复可能花费几小时或几天。</p>
<p>6、ReiserFS</p>
<p>ReiserFS 的第一次公开亮相是在 1997 年 7 月 23 日,Hans Reiser 把他的基于平衡树结构的 ReiserFS 文件系统在网上公布。ReiserFS 3.6.x 是由 Hans Reiser 和他的在 Namesys的开发组共同开发设计的。Reiserfs 被看作是一个更加激进和现代的文件系统。传统的UNIX 文件系统是按盘块来进行空间分配的,对于目录和文件等的查找使用了简单的线性查找。这些设计在当时是合适的,但随着磁盘容量的增大和应用需求的增加,传统文件系统在存储效率,速度和功能上已显落后。 ReiserFS 一个最受人批评的缺点是每升级一个版本,都将要将磁盘重新格式化一次。</p>
<p>7、xfs</p>
<p>xfs 是一种非常优秀的日志文件系统,它是 SGI 公司设计的。xfs 被称为业界最先进的、最具可升级性的文件系统技术。SGI 的 xfs 可为 linux 和开放资源社区带来的新特性有:可升级性:xfs 被设计成可升级,以面对大多数的存储容量和 i/o 存储需求,可处理大型文件和包含巨大数量文件的大型目录,满足二十一世纪快速增长的磁盘需求。xfs 有能力动态地为文件分配索引空间,使系统形成高效支持大数量文件的能力。优秀的 i/o 性能:典型的现代服务器使用大型的条带式磁盘阵列,以提供达数 gb/秒的总带宽。xfs 可以很好地满足 I/O 请求的大小和并发 I/O 请求的数量。xfs 可作为 root 文件系统,并被 lilo 支持.在 NFS 服务器上使用也没问题.支持软件磁盘阵列(RAID)和虚拟集群(LVM)。由于 xfs 比较复杂,实施起来有一些难度,所以目前 xfs 主要应用于 </p>
<p>特性</p>
<p>ext2</p>
<p>ext3</p>
<p>ReiserFS3.6（不受 Oracle 支持）</p>
<p>最大分区大小</p>
<p>4TB</p>
<p>4TB</p>
<p>16TB</p>
<p>最大文件大小</p>
<p>2GB-4GB</p>
<p>2GB-4GB</p>
<p>8TB</p>
<p>块大小</p>
<p>1KB-4KB</p>
<p>1KB-4KB</p>
<p>只有 4KB</p>
<p>日志功能</p>
<p>无</p>
<p>是</p>
<p>有</p>
<p>崩溃后重新启动</p>
<p>慢</p>
<p>快</p>
<p>非常快</p>
<p>用于恢复清除文件的工具</p>
<p>有</p>
<p>有</p>
<p>无</p>
<p>崩溃后数据的状态</p>
<p>良好</p>
<p>非常好</p>
<p>一般</p>
<p>ACL 支持</p>
<p>有</p>
<p>有</p>
<p>无</p>
<p>稳定性</p>
<p>优秀</p>
<p>良好</p>
<p>良好</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2011/08/15/ext3-ext4-file-system-large-partition-support/" data-id="cji00lkb2004rhnzsr8lojmnu" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ext3/">ext3</a></li><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/ext4/">ext4</a></li></ul>

    </footer>
  </div>
  
</article>


  
    <article id="post-use-inode-to-delete-files-under-linux" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/08/08/use-inode-to-delete-files-under-linux/" class="article-date">
  <time datetime="2011-08-08T03:09:44.000Z" itemprop="datePublished">2011-08-08</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/默认分类/">默认分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2011/08/08/use-inode-to-delete-files-under-linux/">Linux下使用inode删除文件</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Linux 下有时候某些文件无法使用 rm 直接删除, 比如该文件的文件名含有终端不能正确显示的字符.<br># ls -li<br>total 0<br>441511 -rw-r–r– 1 root root 0 Apr 6 23:13 ???}????<br>当然如果该文件夹下没有别的文件. 可以直接 rm -rf * 删除,但是如果有别的不想删除的. 就只能通过 inode 删除了<br># find . -inum 441511 -delete<br>rm -i `find . -maxdepth 1 -inum 45656 -print`</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2011/08/08/use-inode-to-delete-files-under-linux/" data-id="cji00lksw00jthnzscymz4mq6" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-the-difference-between-memory-buffer-and-cache-in-the-linux-operating-system" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/08/03/the-difference-between-memory-buffer-and-cache-in-the-linux-operating-system/" class="article-date">
  <time datetime="2011-08-03T08:34:25.000Z" itemprop="datePublished">2011-08-03</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/默认分类/">默认分类</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2011/08/03/the-difference-between-memory-buffer-and-cache-in-the-linux-operating-system/">Linux操作系统中内存buffer和cache的区别</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>Free<br>　　free 命令相对于top 提供了更简洁的查看系统内存使用情况：</p>
<p>　　$ free<br>　　total used free shared buffers cachedMem: 255268 238332 16936 0 85540 126384-/+ buffers/cache: 26408 228860Swap: 265000 0 265000</p>
<p>　　Mem：表示物理内存统计<br>　　-/+ buffers/cached：表示物理内存的缓存统计<br>　　Swap：表示硬盘上交换分区的使用情况，这里我们不去关心。</p>
<p>　　系统的总物理内存：255268Kb（256M），但系统当前真正可用的内存b并不是第一行free 标记的 16936Kb，它仅代表未被分配的内存。</p>
<p>　　我们使用total1、used1、free1、used2、free2 等名称来代表上面统计数据的各值，1、2 分别代表第一行和第二行的数据。</p>
<p>　　total1：表示物理内存总量。</p>
<p>　　used1：表示总计分配给缓存（包含buffers 与cache ）使用的数量，但其中可能部分缓存并未实际使用。</p>
<p>　　free1：未被分配的内存。</p>
<p>　　shared1：共享内存，一般系统不会用到，这里也不讨论。</p>
<p>　　buffers1：系统分配但未被使用的buffers 数量。</p>
<p>　　cached1：系统分配但未被使用的cache 数量。buffer 与cache 的区别见后面。</p>
<p>　　used2：实际使用的buffers 与cache 总量，也是实际使用的内存总量。</p>
<p>　　free2：未被使用的buffers 与cache 和未被分配的内存之和，这就是系统当前实际可用内存。</p>
<p>　　可以整理出如下等式：<br>　　total1 = used1 + free1total1 = used2 + free2used1 = buffers1 + cached1 + used2free2 = buffers1 + cached1 + free1</p>
<p>　　buffer 与cache 的区别<br>　　A buffer is something that has yet to be “written” to disk. A cache is something that has been “read” from the disk and stored for later use.</p>
<p>　　更详细的解释参考：Difference Between Buffer and Cache</p>
<p>　　对于共享内存（Shared memory），主要用于在UNIX 环境下不同进程之间共享数据，是进程间通信的一种方法，一般的应用程序不会申请使用共享内存，笔者也没有去验证共享内存对上面等式的影响。如果你有兴趣， 请参考：What is Shared Memory?</p>
<p>　　cache 和 buffer的区别：<br>　　Cache：高速缓存，是位于CPU与主内存间的一种容量较小但速度很高的存储器。由于 CPU的速度远高于主内存，CPU直接从内存中存取数据要等待一定时间周期，Cache中保存着CPU刚用过或循环使用的一部分数据，当CPU再次使用该 部分数据时可从Cache中直接调用,这样就减少了CPU的等待时间,提高了系统的效率。Cache又分为一级Cache(L1 Cache)和二级Cache(L2 Cache)，L1 Cache集成在CPU内部，L2 Cache早期一般是焊在主板上,现在也都集成在CPU内部，常见的容量有256KB或512KB L2 Cache。</p>
<p>　　Buffer：缓冲区，一个用于存储速度不同步的设备或优先级不同的设备之间传输数据的区域。通过缓冲区，可以使进程之间的相互等待变少，从而使从速度慢的设备读入数据时，速度快的设备的操作进程不发生间断。</p>
<p>　　Free中的buffer和cache：（它们都是占用内存）：</p>
<p>　　buffer : 作为buffer cache的内存，是块设备的读写缓冲区</p>
<p>　　cache: 作为page cache的内存, 文件系统的cache</p>
<p>　　如果 cache 的值很大，说明cache住的文件数很多。如果频繁访问到的文件都能被cache住，那么磁盘的读IO bi会非常小。</p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2011/08/03/the-difference-between-memory-buffer-and-cache-in-the-linux-operating-system/" data-id="cji00lknr00fnhnzsj3uvtxo3" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  
    <article id="post-under-linux-different-ip-addresses-are-in-the-same-network-segment" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2011/07/22/under-linux-different-ip-addresses-are-in-the-same-network-segment/" class="article-date">
  <time datetime="2011-07-22T06:17:21.000Z" itemprop="datePublished">2011-07-22</time>
</a>
    
  <div class="article-category">
    <a class="article-category-link" href="/categories/linux/">linux</a>
  </div>

  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2011/07/22/under-linux-different-ip-addresses-are-in-the-same-network-segment/">Linux下多网卡不同IP在同一网段的情况</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>今天在看Intel 1000 PT网卡的驱动时，有如下信息：</p>
<p>Multiple Interfaces on Same Ethernet Broadcast Network</p>
<p>echo 1 &gt; /proc/sys/net/ipv4/conf/all/arp_filter</p>
<p>google了一下，有人已经试验了这个，摘录如下：</p>
<p><a href="http://blog.sina.com.cn/s/blog_544465b0010000kf.html" target="_blank" rel="noopener">http://blog.sina.com.cn/s/blog_544465b0010000kf.html</a></p>
<p><strong>多网卡在同一网段内的问题</strong>(2005-11-23 23:38:42)</p>
<p>分类：<a href="http://blog.sina.com.cn/s/articlelist_1413768624_5_1.html" target="_blank" rel="noopener">网络安全</a></p>
<p>关键字：Strict Interface ARP, Multi-link, Multipath, Multiple network cards on same subnet problem  </p>
<p>公司那个提供音乐下载的域名流量直逼 1Gbps，但是系统的连接却不高，服务器用的是DELL2850的，板载两个Gbe的网口，还插了两块Intel的Gbe网卡，因此打算通过多网卡的负 载均衡扩充一下系统的网络带宽。但是不想用多网卡的邦定，感觉那样不太灵活，因此决定采用Advanced Routing来解决这个问题。</p>
<p>查了一下 man ip，然后开始做了：</p>
<p>1) 给四个网口配置了四个地址</p>
<p>2) 在BIGIP上面把四个地址都加入到负载均衡</p>
<p>3) 用ip命令实现多网卡负载均衡</p>
<p>ip route replace default equalize scope global nexthop via 172.24.x.11 dev eth0 weight 1 nexthop via 172.24.x.11 dev eth1 weight 1 nexthop via 172.24.x.1 dev eth2 weight 1 nexthop via 172.24.x.11 dev eth3 weight 1</p>
<p>立即看到所有的流量被均衡到4个网口</p>
<p>但是出现了新的问题，大量的IP地址冲突信息出现在BIGIP的日志：</p>
<p>Nov 23 19:18:56 tc04 kernel: arp info overwritten for 172.24.x.30 by 00:14:22:1b:94:dc<br>Nov 23 20:30:24 tc04 kernel: arp info overwritten for 172.24.x.30 by 00:04:23:c0:5c:88<br>Nov 23 20:30:28 tc04 kernel: arp info overwritten for 172.24.x.30 by 00:14:22:1b:94:dc<br>Nov 23 21:03:14 tc04 kernel: arp info overwritten for 172.24.x.30 by 00:14:22:1b:94:dd</p>
<p>发现出现的几个产生IP冲突的MAC地址都是这台机器上面其他的网口的MAC，这就奇怪了。</p>
<p>通过tcpdump抓包，分析ARP信息发现是因为Linux响应ARP请求的时候，使用的IP地址并未被严格的限定，因此导致了这个问题。</p>
<p>很快 Google 到这篇文章：<a href="http://oss.sgi.com/projects/netdev/archive/2001-09/msg00098.html" target="_blank" rel="noopener">[PATCH] strict interface arp patch for Linux 2.4.2</a></p>
<p>然后就跑去 <a href="http://www.linuxvirtualserver.org/" target="_blank" rel="noopener">http://www.linuxvirtualserver.org/</a> 找到 <a href="http://www.linuxvirutalserver.org/docs/arp.html" target="_blank" rel="noopener">http://www.linuxvirutalserver.org/docs/arp.html</a></p>
<p>发现没有什么可用的信息，然后就硬着头皮进入到 /proc/sys/net/ipv4/conf/all 目录看看有啥线索是解决2.6的</p>
<p>看到三个文件 arp_announce, arp_ignore, arp_filter</p>
<p>立即去 /usr/src/linux/Documentation/networking/ip-sysctl.txt 找到相关的说明：</p>
<p>arp_filter - BOOLEAN<br>        1 - Allows you to have multiple network interfaces on the same<br>        subnet, and have the ARPs for each interface be answered<br>        based on whether or not the kernel would route a packet from<br>        the ARP’d IP out that interface (therefore you must use source<br>        based routing for this to work). In other words it allows control<br>        of which cards (usually 1) will respond to an arp request.</p>
<pre><code>0 - (default) The kernel can respond to arp requests with addresses  
from other interfaces. This may seem wrong but it usually makes  
sense, because it increases the chance of successful communication.  
IP addresses are owned by the complete host on Linux, not by  
particular interfaces. Only for more complex setups like load-  
balancing, does this behaviour cause problems.

arp_filter for the interface will be enabled if at least one of  
conf/{all,interface}/arp_filter is set to TRUE,  
it will be di sabled otherwise
</code></pre><p>arp_announce - INTEGER<br>        Define different restriction levels for announcing the local<br>        source IP address from IP packets in ARP requests sent on<br>        interface:<br>        0 - (default) Use any local address, configured on any interface<br>        1 - Try to avoid local addresses that are not in the target’s<br>        subnet for this interface. This mode is useful when target<br>        hosts reachable via this interface require the source IP<br>        address in ARP requests to be part of their logical network<br>        configured on the receiving interface. When we generate the<br>        request we will check all our subnets that include the<br>        target IP and will preserve the source address if it is from<br>        such subnet. If there is no such subnet we select source<br>        address according to the rules for level 2.<br>        2 - Always use the best local address for this target.<br>        In this mode we ignore the source address in the IP packet<br>        and try to select local address that we prefer for talks with<br>        the target host. Such local address is selected by looking<br>        for primary IP addresses on all our subnets on the outgoing<br>        interface that include the target IP address. If no suitable<br>        local address is found we select the first local address<br>        we have on the outgoing interface or on all other interfaces,<br>        with the hope we will receive reply for our request and<br>        even sometimes no matter the source IP address we announce.</p>
<pre><code>The max value from conf/{all,interface}/arp_announce is used.

Increasing the restriction level gives more chance for  
receiving answer from the resolved target while decreasing  
the level announces more valid sender&apos;s information.
</code></pre><p>arp_ignore - INTEGER<br>        Define different modes for sending replies in response to<br>        received ARP requests that resolve local target IP addresses:<br>        0 - (default): reply for any local target IP address, configured<br>        on any interface<br>        1 - reply only if the target IP address is local address<br>        configured on the incoming interface<br>        2 - reply only if the target IP address is local address<br>        configured on the incoming interface and both with the<br>        sender’s IP address are part from same subnet on this interface<br>        3 - do not reply for local addresses configured with scope host,<br>        only resolutions for global and link addresses are replied<br>        4-7 - reserved<br>        8 - do not reply for all local addresses</p>
<pre><code>The max value from conf/{all,interface}/arp_ignore is used  
when ARP request is received on the {interface}
</code></pre><p>嘿嘿，通过：</p>
<p>echo 2 &gt; /proc/sys/net/ipv4/conf/all/arp_announce</p>
<p>echo 1 &gt; /proc/sys/net/ipv4/conf/all/arp_ignore</p>
<p>or</p>
<p>echo 1 &gt; /proc/sys/net/ipv4/conf/all/arp_filter</p>
<p>立即搞定！</p>
<p>继续 Google 了一些信息，发现前面两个内核控制好像是在 2.6.5 实现的 :-)</p>
<p>推荐用前面的两个，arp_filter应该也能解决，感觉前面的两个是对arp_filter的更细节控制的实现。</p>
<p>然后还发现在inter pro/1000的网卡驱动的安装指南里面也有一节：</p>
<p>Multiple Interfaces on Same Ethernet Broadcast Network<br>------------------------------------------------------</p>
<p>Due to the default ARP behavior on Linux, it is not possible to have<br>one system on two IP networks in the same Ethernet broadcast domain<br>(non-partitioned switch) behave as expected. All Ethernet interfaces<br>will respond to IP traffic for any IP address assigned to the system.<br>This results in unbalanced receive traffic.</p>
<p>If you have multiple interfaces in a server, either turn on ARP<br>filtering by entering:</p>
<p>echo 1 &gt; /proc/sys/net/ipv4/conf/all/arp_filter<br>(this only works if your kernel’s version is higher than 2.4.5),</p>
<p>or,</p>
<p>install the interfaces in separate broadcast domains (either<br>in different switches or in a switch partitioned to VLANs).</p>
<p>参考信息：</p>
<p><a href="http://linux-ip.net/html/ether-arp.html" target="_blank" rel="noopener">http://linux-ip.net/html/ether-arp.html</a></p>
<p><a href="http://www.austintek.com/LVS/LVS-HOWTO/HOWTO/LVS-HOWTO.arp_problem.html" target="_blank" rel="noopener">http://www.austintek.com/LVS/LVS-HOWTO/HOWTO/LVS-HOWTO.arp_problem.html</a></p>
<p><a href="http://www.ssi.bg/%7Eja/#arp_announce" target="_blank" rel="noopener">http://www.ssi.bg/~ja/#arp_announce</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="http://yoursite.com/2011/07/22/under-linux-different-ip-addresses-are-in-the-same-network-segment/" data-id="cji00lks700jdhnzs8lne6iwe" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>


  


  <nav id="page-nav">
    
    <a class="extend prev" rel="prev" href="/page/3/">&laquo; Prev</a><a class="page-number" href="/">1</a><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="page-number current">4</span><a class="page-number" href="/page/5/">5</a><a class="page-number" href="/page/6/">6</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="extend next" rel="next" href="/page/5/">Next &raquo;</a>
  </nav>

</section>
        
          <aside id="sidebar">
  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Categories</h3>
    <div class="widget">
      <ul class="category-list"><li class="category-list-item"><a class="category-list-link" href="/categories/HR/">HR</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/MAC/">MAC</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/docker/">docker</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/linux/">linux</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/windows/">windows</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/生活琐事/">生活琐事</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/网络美文/">网络美文</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/进步进行中/">进步进行中</a></li><li class="category-list-item"><a class="category-list-link" href="/categories/默认分类/">默认分类</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/n/">-n</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/proc-pid-stat/">/proc/[pid]/stat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/12-04/">12.04</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/3/">3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/413/">413</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/442/">442</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/500k/">500k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/5709网卡异常down分析与解决/">5709网卡异常down分析与解决</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/7/">7</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/access、hybrid和trunk三种模式的理解/">access、hybrid和trunk三种模式的理解</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/adhoc/">adhoc</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/adsl的上行带宽参考/">adsl的上行带宽参考</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/altered/">altered</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ambiguous/">ambiguous</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/blktrace使用简析/">blktrace使用简析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/broadcom/">broadcom</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/cluster/">cluster</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/comodo与cisco/">comodo与cisco</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/dpi和ppi的区别/">dpi和ppi的区别</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/enable/">enable</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/entity/">entity</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/eth0/">eth0:</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ext3/">ext3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ext4/">ext4</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/failed/">failed</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/faq/">faq</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/fastdfs/">fastdfs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/file-max/">file-max</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/gns3/">gns3</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hal-set-property修改lshal信息/">hal-set-property修改lshal信息</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/how/">how</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/http/">http</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/install/">install</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/io-c/">io.c</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/iowait高的一些处理方法/">iowait高的一些处理方法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/key/">key</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/kvm/">kvm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/large/">large</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/last/">last</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux/">linux</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux下/">linux下</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux下-proc-stat/">linux下/proc/stat</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux下可用内存只有不到4g/">linux下可用内存只有不到4g</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux下文件大小不一致的情况分析/">linux下文件大小不一致的情况分析</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux下替换运行中的程序/">linux下替换运行中的程序</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux中时间戳转换命令/">linux中时间戳转换命令</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux使用iptables实现-邮件-端口重定向/">linux使用iptables实现(邮件)端口重定向</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/linux网卡-设置千兆网卡速度及模式/">linux网卡(设置千兆网卡速度及模式)</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/memcache的限制/">memcache的限制</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/memcahced/">memcahced</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/message/">message</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/messages/">messages</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/modinfo/">modinfo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/module/">module</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/mysql/">mysql</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/netdev/">netdev</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx/">nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx-upstream-jvm-route插件/">nginx-upstream-jvm-route插件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx-http-push-module/">nginx_http_push_module</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx出现/">nginx出现</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nginx版本无缝升级/">nginx版本无缝升级</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/of/">of</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/on/">on</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/out/">out</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/outside/">outside</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/over/">over</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/printk/">printk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/push/">push</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/read/">read</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/reason/">reason</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redirect/">redirect</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/redis/">redis</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/repeate/">repeate</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/request/">request</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rhel5-4安装spacewalk/">rhel5.4安装spacewalk</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rpm/">rpm</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rpmdb/">rpmdb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rsync/">rsync</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/rz上传出错问题/">rz上传出错问题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sendmail主题乱码/">sendmail主题乱码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/sl410k/">sl410k</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/snapshot/">snapshot</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh/">ssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ssh登录很慢的问题/">ssh登录很慢的问题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/support/">support</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/suppressed/">suppressed</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tag/">tag</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/timed/">timed</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/to/">to</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/too/">too</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/transmit/">transmit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ttserver/">ttserver</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ubuntu/">ubuntu</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/ulimit/">ulimit</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/unexpected/">unexpected</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/upstream-hash/">upstream_hash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/url-hash/">url_hash</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/users/">users</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/value/">value</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/virtio/">virtio</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vmware/">vmware</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vncviewer/">vncviewer</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vpn蓝屏解决记/">vpn蓝屏解决记</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vsftpd/">vsftpd</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/vsftpd时区/">vsftpd时区</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/warning/">warning:</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/watchdog/">watchdog:</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wget整站下载/">wget整站下载</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/while/">while</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/wifi/">wifi</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/x/">x</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/xcutsel/">xcutsel</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/yum升级python26/">yum升级python26</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zeroconf/">zeroconf</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/zssh/">zssh</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/主目录/">主目录</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/乱码/">乱码</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/传输剪贴板/">传输剪贴板</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/但东西没有回收/">但东西没有回收</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/修改/">修改</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/关于金钱/">关于金钱</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/删除了文件/">删除了文件</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/动态增加数据节点配置步骤/">动态增加数据节点配置步骤</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/升级nginx/">升级nginx</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/去广告方法/">去广告方法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/取得前3天前1小时前一分钟的时间/">取得前3天前1小时前一分钟的时间</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/命令小结/">命令小结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/命令行查看memcache状态/">命令行查看memcache状态</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/如何查看linux内核是否为64位版本？/">如何查看linux内核是否为64位版本？</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/如何查看rpm包的更新日志changelog/">如何查看rpm包的更新日志changelog</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/妈妈/">妈妈</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/将nginx配置成url-hash转发方式/">将nginx配置成url_hash转发方式</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/小猪/">小猪</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/尾巴/">尾巴</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/平滑/">平滑</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/强制位与冒险位/">强制位与冒险位</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/我相信/">我相信</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/找不到一个要连接的有效/">找不到一个要连接的有效</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/按sessionid转发/">按sessionid转发</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/敌人/">敌人</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/文件解释/">文件解释</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/是否是因为bnx2id的启动而引起的网卡down/">是否是因为bnx2id的启动而引起的网卡down</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/未能初始化远程显示子系统/">未能初始化远程显示子系统</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/查看有多少个交换分区或交换文件在使用的方法/">查看有多少个交换分区或交换文件在使用的方法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/概念/">概念</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/社会规则3则/">社会规则3则</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/福昕pdf阅读器/">福昕pdf阅读器</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/绿色/">绿色</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/英语/">英语</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/藏拙/">藏拙</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/藏锋/">藏锋</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/解决/">解决</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/解决python升级为2-5高版本后yum不能使用的问题/">解决python升级为2.5高版本后yum不能使用的问题</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/计算cpu利用率/">计算cpu利用率</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/课文/">课文</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/课程/">课程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/谈谈背诵新概念英语第四册历程/">谈谈背诵新概念英语第四册历程</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/配置sendmail/">配置sendmail</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/重建rpmdb/">重建rpmdb</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/链接表的附加功能尚未激活的解决方法/">链接表的附加功能尚未激活的解决方法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/错误解决方法/">错误解决方法</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/问题解决办法小结/">问题解决办法小结</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/限制/">限制</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/n/" style="font-size: 10px;">-n</a> <a href="/tags/proc-pid-stat/" style="font-size: 10px;">/proc/[pid]/stat</a> <a href="/tags/12-04/" style="font-size: 10px;">12.04</a> <a href="/tags/3/" style="font-size: 10px;">3</a> <a href="/tags/413/" style="font-size: 10px;">413</a> <a href="/tags/442/" style="font-size: 10px;">442</a> <a href="/tags/500k/" style="font-size: 10px;">500k</a> <a href="/tags/5709网卡异常down分析与解决/" style="font-size: 10px;">5709网卡异常down分析与解决</a> <a href="/tags/7/" style="font-size: 10px;">7</a> <a href="/tags/access、hybrid和trunk三种模式的理解/" style="font-size: 10px;">access、hybrid和trunk三种模式的理解</a> <a href="/tags/adhoc/" style="font-size: 10px;">adhoc</a> <a href="/tags/adsl的上行带宽参考/" style="font-size: 10px;">adsl的上行带宽参考</a> <a href="/tags/altered/" style="font-size: 10px;">altered</a> <a href="/tags/ambiguous/" style="font-size: 10px;">ambiguous</a> <a href="/tags/blktrace使用简析/" style="font-size: 10px;">blktrace使用简析</a> <a href="/tags/broadcom/" style="font-size: 10px;">broadcom</a> <a href="/tags/cluster/" style="font-size: 10px;">cluster</a> <a href="/tags/comodo与cisco/" style="font-size: 10px;">comodo与cisco</a> <a href="/tags/dpi和ppi的区别/" style="font-size: 10px;">dpi和ppi的区别</a> <a href="/tags/enable/" style="font-size: 10px;">enable</a> <a href="/tags/entity/" style="font-size: 10px;">entity</a> <a href="/tags/eth0/" style="font-size: 10px;">eth0:</a> <a href="/tags/ext3/" style="font-size: 10px;">ext3</a> <a href="/tags/ext4/" style="font-size: 10px;">ext4</a> <a href="/tags/failed/" style="font-size: 10px;">failed</a> <a href="/tags/faq/" style="font-size: 10px;">faq</a> <a href="/tags/fastdfs/" style="font-size: 10px;">fastdfs</a> <a href="/tags/file-max/" style="font-size: 10px;">file-max</a> <a href="/tags/gns3/" style="font-size: 10px;">gns3</a> <a href="/tags/hal-set-property修改lshal信息/" style="font-size: 10px;">hal-set-property修改lshal信息</a> <a href="/tags/how/" style="font-size: 10px;">how</a> <a href="/tags/http/" style="font-size: 10px;">http</a> <a href="/tags/install/" style="font-size: 10px;">install</a> <a href="/tags/io-c/" style="font-size: 10px;">io.c</a> <a href="/tags/iowait高的一些处理方法/" style="font-size: 10px;">iowait高的一些处理方法</a> <a href="/tags/key/" style="font-size: 10px;">key</a> <a href="/tags/kvm/" style="font-size: 15px;">kvm</a> <a href="/tags/large/" style="font-size: 10px;">large</a> <a href="/tags/last/" style="font-size: 10px;">last</a> <a href="/tags/linux/" style="font-size: 15px;">linux</a> <a href="/tags/linux下/" style="font-size: 10px;">linux下</a> <a href="/tags/linux下-proc-stat/" style="font-size: 10px;">linux下/proc/stat</a> <a href="/tags/linux下可用内存只有不到4g/" style="font-size: 10px;">linux下可用内存只有不到4g</a> <a href="/tags/linux下文件大小不一致的情况分析/" style="font-size: 10px;">linux下文件大小不一致的情况分析</a> <a href="/tags/linux下替换运行中的程序/" style="font-size: 10px;">linux下替换运行中的程序</a> <a href="/tags/linux中时间戳转换命令/" style="font-size: 10px;">linux中时间戳转换命令</a> <a href="/tags/linux使用iptables实现-邮件-端口重定向/" style="font-size: 10px;">linux使用iptables实现(邮件)端口重定向</a> <a href="/tags/linux网卡-设置千兆网卡速度及模式/" style="font-size: 10px;">linux网卡(设置千兆网卡速度及模式)</a> <a href="/tags/memcache的限制/" style="font-size: 10px;">memcache的限制</a> <a href="/tags/memcahced/" style="font-size: 10px;">memcahced</a> <a href="/tags/message/" style="font-size: 10px;">message</a> <a href="/tags/messages/" style="font-size: 10px;">messages</a> <a href="/tags/modinfo/" style="font-size: 10px;">modinfo</a> <a href="/tags/module/" style="font-size: 10px;">module</a> <a href="/tags/mysql/" style="font-size: 10px;">mysql</a> <a href="/tags/netdev/" style="font-size: 10px;">netdev</a> <a href="/tags/nginx/" style="font-size: 15px;">nginx</a> <a href="/tags/nginx-upstream-jvm-route插件/" style="font-size: 10px;">nginx-upstream-jvm-route插件</a> <a href="/tags/nginx-http-push-module/" style="font-size: 10px;">nginx_http_push_module</a> <a href="/tags/nginx出现/" style="font-size: 10px;">nginx出现</a> <a href="/tags/nginx版本无缝升级/" style="font-size: 10px;">nginx版本无缝升级</a> <a href="/tags/of/" style="font-size: 10px;">of</a> <a href="/tags/on/" style="font-size: 10px;">on</a> <a href="/tags/out/" style="font-size: 10px;">out</a> <a href="/tags/outside/" style="font-size: 10px;">outside</a> <a href="/tags/over/" style="font-size: 10px;">over</a> <a href="/tags/printk/" style="font-size: 10px;">printk</a> <a href="/tags/push/" style="font-size: 10px;">push</a> <a href="/tags/read/" style="font-size: 10px;">read</a> <a href="/tags/reason/" style="font-size: 10px;">reason</a> <a href="/tags/redirect/" style="font-size: 10px;">redirect</a> <a href="/tags/redis/" style="font-size: 10px;">redis</a> <a href="/tags/repeate/" style="font-size: 10px;">repeate</a> <a href="/tags/request/" style="font-size: 10px;">request</a> <a href="/tags/rhel5-4安装spacewalk/" style="font-size: 10px;">rhel5.4安装spacewalk</a> <a href="/tags/rpm/" style="font-size: 10px;">rpm</a> <a href="/tags/rpmdb/" style="font-size: 10px;">rpmdb</a> <a href="/tags/rsync/" style="font-size: 15px;">rsync</a> <a href="/tags/rz上传出错问题/" style="font-size: 10px;">rz上传出错问题</a> <a href="/tags/sendmail主题乱码/" style="font-size: 10px;">sendmail主题乱码</a> <a href="/tags/sl410k/" style="font-size: 10px;">sl410k</a> <a href="/tags/snapshot/" style="font-size: 10px;">snapshot</a> <a href="/tags/ssh/" style="font-size: 10px;">ssh</a> <a href="/tags/ssh登录很慢的问题/" style="font-size: 10px;">ssh登录很慢的问题</a> <a href="/tags/support/" style="font-size: 10px;">support</a> <a href="/tags/suppressed/" style="font-size: 10px;">suppressed</a> <a href="/tags/tag/" style="font-size: 10px;">tag</a> <a href="/tags/timed/" style="font-size: 10px;">timed</a> <a href="/tags/to/" style="font-size: 20px;">to</a> <a href="/tags/too/" style="font-size: 10px;">too</a> <a href="/tags/transmit/" style="font-size: 10px;">transmit</a> <a href="/tags/ttserver/" style="font-size: 10px;">ttserver</a> <a href="/tags/ubuntu/" style="font-size: 15px;">ubuntu</a> <a href="/tags/ulimit/" style="font-size: 10px;">ulimit</a> <a href="/tags/unexpected/" style="font-size: 10px;">unexpected</a> <a href="/tags/upstream-hash/" style="font-size: 10px;">upstream_hash</a> <a href="/tags/url-hash/" style="font-size: 10px;">url_hash</a> <a href="/tags/users/" style="font-size: 10px;">users</a> <a href="/tags/value/" style="font-size: 10px;">value</a> <a href="/tags/virtio/" style="font-size: 10px;">virtio</a> <a href="/tags/vmware/" style="font-size: 10px;">vmware</a> <a href="/tags/vncviewer/" style="font-size: 10px;">vncviewer</a> <a href="/tags/vpn蓝屏解决记/" style="font-size: 10px;">vpn蓝屏解决记</a> <a href="/tags/vsftpd/" style="font-size: 10px;">vsftpd</a> <a href="/tags/vsftpd时区/" style="font-size: 10px;">vsftpd时区</a> <a href="/tags/warning/" style="font-size: 10px;">warning:</a> <a href="/tags/watchdog/" style="font-size: 10px;">watchdog:</a> <a href="/tags/wget整站下载/" style="font-size: 10px;">wget整站下载</a> <a href="/tags/while/" style="font-size: 10px;">while</a> <a href="/tags/wifi/" style="font-size: 10px;">wifi</a> <a href="/tags/x/" style="font-size: 10px;">x</a> <a href="/tags/xcutsel/" style="font-size: 10px;">xcutsel</a> <a href="/tags/yum升级python26/" style="font-size: 10px;">yum升级python26</a> <a href="/tags/zeroconf/" style="font-size: 10px;">zeroconf</a> <a href="/tags/zssh/" style="font-size: 10px;">zssh</a> <a href="/tags/主目录/" style="font-size: 10px;">主目录</a> <a href="/tags/乱码/" style="font-size: 10px;">乱码</a> <a href="/tags/传输剪贴板/" style="font-size: 10px;">传输剪贴板</a> <a href="/tags/但东西没有回收/" style="font-size: 10px;">但东西没有回收</a> <a href="/tags/修改/" style="font-size: 10px;">修改</a> <a href="/tags/关于金钱/" style="font-size: 10px;">关于金钱</a> <a href="/tags/删除了文件/" style="font-size: 10px;">删除了文件</a> <a href="/tags/动态增加数据节点配置步骤/" style="font-size: 10px;">动态增加数据节点配置步骤</a> <a href="/tags/升级nginx/" style="font-size: 10px;">升级nginx</a> <a href="/tags/去广告方法/" style="font-size: 10px;">去广告方法</a> <a href="/tags/取得前3天前1小时前一分钟的时间/" style="font-size: 10px;">取得前3天前1小时前一分钟的时间</a> <a href="/tags/命令小结/" style="font-size: 10px;">命令小结</a> <a href="/tags/命令行查看memcache状态/" style="font-size: 10px;">命令行查看memcache状态</a> <a href="/tags/如何查看linux内核是否为64位版本？/" style="font-size: 10px;">如何查看linux内核是否为64位版本？</a> <a href="/tags/如何查看rpm包的更新日志changelog/" style="font-size: 10px;">如何查看rpm包的更新日志changelog</a> <a href="/tags/妈妈/" style="font-size: 10px;">妈妈</a> <a href="/tags/将nginx配置成url-hash转发方式/" style="font-size: 10px;">将nginx配置成url_hash转发方式</a> <a href="/tags/小猪/" style="font-size: 10px;">小猪</a> <a href="/tags/尾巴/" style="font-size: 10px;">尾巴</a> <a href="/tags/平滑/" style="font-size: 10px;">平滑</a> <a href="/tags/强制位与冒险位/" style="font-size: 10px;">强制位与冒险位</a> <a href="/tags/我相信/" style="font-size: 10px;">我相信</a> <a href="/tags/找不到一个要连接的有效/" style="font-size: 10px;">找不到一个要连接的有效</a> <a href="/tags/按sessionid转发/" style="font-size: 10px;">按sessionid转发</a> <a href="/tags/敌人/" style="font-size: 10px;">敌人</a> <a href="/tags/文件解释/" style="font-size: 10px;">文件解释</a> <a href="/tags/是否是因为bnx2id的启动而引起的网卡down/" style="font-size: 10px;">是否是因为bnx2id的启动而引起的网卡down</a> <a href="/tags/未能初始化远程显示子系统/" style="font-size: 10px;">未能初始化远程显示子系统</a> <a href="/tags/查看有多少个交换分区或交换文件在使用的方法/" style="font-size: 10px;">查看有多少个交换分区或交换文件在使用的方法</a> <a href="/tags/概念/" style="font-size: 10px;">概念</a> <a href="/tags/社会规则3则/" style="font-size: 10px;">社会规则3则</a> <a href="/tags/福昕pdf阅读器/" style="font-size: 10px;">福昕pdf阅读器</a> <a href="/tags/绿色/" style="font-size: 10px;">绿色</a> <a href="/tags/英语/" style="font-size: 15px;">英语</a> <a href="/tags/藏拙/" style="font-size: 10px;">藏拙</a> <a href="/tags/藏锋/" style="font-size: 10px;">藏锋</a> <a href="/tags/解决/" style="font-size: 10px;">解决</a> <a href="/tags/解决python升级为2-5高版本后yum不能使用的问题/" style="font-size: 10px;">解决python升级为2.5高版本后yum不能使用的问题</a> <a href="/tags/计算cpu利用率/" style="font-size: 10px;">计算cpu利用率</a> <a href="/tags/课文/" style="font-size: 10px;">课文</a> <a href="/tags/课程/" style="font-size: 10px;">课程</a> <a href="/tags/谈谈背诵新概念英语第四册历程/" style="font-size: 10px;">谈谈背诵新概念英语第四册历程</a> <a href="/tags/配置sendmail/" style="font-size: 10px;">配置sendmail</a> <a href="/tags/重建rpmdb/" style="font-size: 10px;">重建rpmdb</a> <a href="/tags/链接表的附加功能尚未激活的解决方法/" style="font-size: 10px;">链接表的附加功能尚未激活的解决方法</a> <a href="/tags/错误解决方法/" style="font-size: 10px;">错误解决方法</a> <a href="/tags/问题解决办法小结/" style="font-size: 10px;">问题解决办法小结</a> <a href="/tags/限制/" style="font-size: 10px;">限制</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/04/">April 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/03/">March 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2018/01/">January 2018</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/08/">August 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/07/">July 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2012/01/">January 2012</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/12/">December 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/11/">November 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/10/">October 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/09/">September 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/08/">August 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/07/">July 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/06/">June 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/05/">May 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/04/">April 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/03/">March 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/02/">February 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2011/01/">January 2011</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/12/">December 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/11/">November 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/10/">October 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/09/">September 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/08/">August 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/07/">July 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/06/">June 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/05/">May 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/03/">March 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2010/01/">January 2010</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2009/12/">December 2009</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2007/11/">November 2007</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2018/04/19/unix-sock-dump-e6-96-b9-e6-b3-95/">unix sock dump方法</a>
          </li>
        
          <li>
            <a href="/2018/04/16/ubuntu-e7-94-a8kubeadm-e5-bf-ab-e9-80-9f-e6-90-ad-e5-bb-bakubernetes-e7-8e-af-e5-a2-83/">ubuntu用kubeadm快速搭建kubernetes环境</a>
          </li>
        
          <li>
            <a href="/2018/04/16/docker-e6-9b-b4-e6-8d-a2-e6-ba-90/">docker更换源</a>
          </li>
        
          <li>
            <a href="/2018/04/02/e8-a7-a3-e5-86-b3docker-e5-88-a0-e9-99-a4container-e5-87-ba-e7-8e-b0device-or-resource-busy/">解决docker删除container出现device or resource busy</a>
          </li>
        
          <li>
            <a href="/2018/03/29/e4-bb-bb-e6-84-8f-e9-82-ae-e7-ae-b1-e4-bc-aa-e9-80-a0-e6-bc-8f-e6-b4-9e-e5-a4-84-e7-90-86/">任意邮箱伪造漏洞处理</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
        
      </div>
      <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2018 John Doe<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
    </div>
    <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
</nav>
    

<script src="//ajax.googleapis.com/ajax/libs/jquery/2.0.3/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>



  </div>
</body>
</html>