<!DOCTYPE html>



  


<html class="theme-next mist use-motion" lang="zh-Hans">
<head>
  <meta charset="UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=edge" />
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
<meta name="theme-color" content="#222">









<meta http-equiv="Cache-Control" content="no-transform" />
<meta http-equiv="Cache-Control" content="no-siteapp" />
















  
  
  <link href="/lib/fancybox/source/jquery.fancybox.css?v=2.1.5" rel="stylesheet" type="text/css" />







<link href="/lib/font-awesome/css/font-awesome.min.css?v=4.6.2" rel="stylesheet" type="text/css" />

<link href="/css/main.css?v=5.1.4" rel="stylesheet" type="text/css" />


  <link rel="apple-touch-icon" sizes="180x180" href="/images/apple-touch-icon-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="32x32" href="/images/favicon-32x32-next.png?v=5.1.4">


  <link rel="icon" type="image/png" sizes="16x16" href="/images/favicon-16x16-next.png?v=5.1.4">


  <link rel="mask-icon" href="/images/logo.svg?v=5.1.4" color="#222">





  <meta name="keywords" content="Hexo, NexT" />










<meta property="og:type" content="website">
<meta property="og:title" content="haitian的博客">
<meta property="og:url" content="http://yoursite.com/page/6/index.html">
<meta property="og:site_name" content="haitian的博客">
<meta property="og:locale" content="zh-Hans">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="haitian的博客">



<script type="text/javascript" id="hexo.configurations">
  var NexT = window.NexT || {};
  var CONFIG = {
    root: '/',
    scheme: 'Mist',
    version: '5.1.4',
    sidebar: {"position":"left","display":"always","offset":12,"b2t":false,"scrollpercent":false,"onmobile":false},
    fancybox: true,
    tabs: true,
    motion: {"enable":true,"async":false,"transition":{"post_block":"fadeIn","post_header":"slideDownIn","post_body":"slideDownIn","coll_header":"slideLeftIn","sidebar":"slideUpIn"}},
    duoshuo: {
      userId: '0',
      author: '博主'
    },
    algolia: {
      applicationID: '',
      apiKey: '',
      indexName: '',
      hits: {"per_page":10},
      labels: {"input_placeholder":"Search for Posts","hits_empty":"We didn't find any results for the search: ${query}","hits_stats":"${hits} results found in ${time} ms"}
    }
  };
</script>



  <link rel="canonical" href="http://yoursite.com/page/6/"/>





  <title>haitian的博客</title>
  








</head>

<body itemscope itemtype="http://schema.org/WebPage" lang="zh-Hans">

  
  
    
  

  <div class="container sidebar-position-left 
  page-home">
    <div class="headband"></div>

    <header id="header" class="header" itemscope itemtype="http://schema.org/WPHeader">
      <div class="header-inner"><div class="site-brand-wrapper">
  <div class="site-meta ">
    

    <div class="custom-logo-site-title">
      <a href="/"  class="brand" rel="start">
        <span class="logo-line-before"><i></i></span>
        <span class="site-title">haitian的博客</span>
        <span class="logo-line-after"><i></i></span>
      </a>
    </div>
      
        <p class="site-subtitle">为了更好的生活而奋斗!</p>
      
  </div>

  <div class="site-nav-toggle">
    <button>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
      <span class="btn-bar"></span>
    </button>
  </div>
</div>

<nav class="site-nav">
  

  
    <ul id="menu" class="menu">
      
        
        <li class="menu-item menu-item-home">
          <a href="/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-home"></i> <br />
            
            首页
          </a>
        </li>
      
        
        <li class="menu-item menu-item-about">
          <a href="/about/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-user"></i> <br />
            
            关于
          </a>
        </li>
      
        
        <li class="menu-item menu-item-tags">
          <a href="/tags/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-tags"></i> <br />
            
            标签
          </a>
        </li>
      
        
        <li class="menu-item menu-item-categories">
          <a href="/categories/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-th"></i> <br />
            
            分类
          </a>
        </li>
      
        
        <li class="menu-item menu-item-archives">
          <a href="/archives/" rel="section">
            
              <i class="menu-item-icon fa fa-fw fa-archive"></i> <br />
            
            归档
          </a>
        </li>
      

      
    </ul>
  

  
</nav>



 </div>
    </header>

    <main id="main" class="main">
      <div class="main-inner">
        <div class="content-wrap">
          <div id="content" class="content">
            
  <section id="posts" class="posts-expand">
    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/03/17/the-limitation-of-memcache/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="haitian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="haitian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/03/17/the-limitation-of-memcache/" itemprop="url">memcache的限制</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-03-17T11:14:42+08:00">
                2011-03-17
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/默认分类/" itemprop="url" rel="index">
                    <span itemprop="name">默认分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>memcache单个缓存值限制为1M(1000000bytes)，超过这个限制的时候会出如下错误。</p>
<blockquote>
<p>ValueError: Values may not be more than 1000000 bytes in length; received 2000000 bytes</p>
</blockquote>
<p>memcache的keys限制为250 bytes，超过这个长度会报错。</p>
<blockquote>
<p>ValueError: Keys may not be more than 250 bytes in length, received 14670 bytes</p>
</blockquote>
<p>memcache的时间设置没限制，但服务器会自动清理缓存，官方好像说过最长为1个月时间(3600*24*30)。</p>
<p>  memcached的简单限制就是键（key）和item的限制。最大键长为250个字符。可以接受的储存数据不能超过1MB，因为这是典型slab 的最大值。这里我们可以突破对key长度的限制。<br>问题解决：<br>修改memcached源文件。在memcached.h中定义key的长度，其代码为：  </p>
<p>#define KEY_MAX_LENGTH 250<br>更换为所需要的长度，比如：1024  </p>
<p>#define KEY_MAX_LENGTH 1024  </p>
<p>但不建议增大key，key大 value小，效率就低了</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/03/09/hal-set-property-modifies-lshal-information/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="haitian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="haitian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/03/09/hal-set-property-modifies-lshal-information/" itemprop="url">hal-set-property修改lshal信息</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-03-09T12:45:56+08:00">
                2011-03-09
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/默认分类/" itemprop="url" rel="index">
                    <span itemprop="name">默认分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>对于使用gnome-mount或者hal的朋友来说，当分区被挂载后，会在桌面上显示”多少G的设备“这样的东西，是不是看着眼烦，现在介绍一种比较简单的方法来修改hal的参数<br>首先，使用hal-device,来查看自动挂载信息，例如hal-device |less 然后查找sda5<br>代码:  </p>
<p>代码</p>
<p>8: udi = ‘/org/freedesktop/Hal/devices/volume_uuid_EE0454B90454868D’<br>  block.minor = 5  (0x5)  (int)<br>  org.freedesktop.Hal.Device.Volume.method_names = { ‘Mount’, ‘Unmount’, ‘Eject’<br>} (string list)<br>  volume.ignore = false  (bool)<br>  volume.label = ‘winE’  (string)<br>  info.capabilities = { ‘volume’, ‘block’ } (string list)<br>  volume.is_partition = true  (bool)<br>  volume.mount_point = ‘/media/winE’  (string)<br>  info.category = ‘volume’  (string)<br>  info.product = ‘Volume (ntfs)’  (string)<br>  volume.is_disc = false  (bool)<br>  volume.is_mounted = true  (bool)<br>  block.is_volume = true  (bool)<br>  volume.linux.is_device_mapper = false  (bool)<br>  block.storage_device = ‘/org/freedesktop/Hal/devices/storage_serial_SATA_ST916<br>0821AS_5MA9TVM1’  (string)<br>  info.parent = ‘/org/freedesktop/Hal/devices/storage_serial_SATA_ST9160821AS_5M<br>A9TVM1’  (string)<br>  volume.block_size = 512  (0x200)  (int)<br>  volume.partition.number = 5  (0x5)  (int)<br>  volume.num_blocks = 182305557  (0xaddc315)  (int)  </p>
<p>volume.fsversion = ‘3.1’  (string)<br>  block.device = ‘/dev/sda5’  (string)<br>  volume.uuid = ‘EE0454B90454868D’  (string)<br>  volume.partition.media_size = 160041885696  (0x25433d6000)  (uint64)<br>  volume.fsusage = ‘filesystem’  (string)<br>  volume.is_mounted_read_only = false  (bool)<br>  org.freedesktop.Hal.Device.Volume.method_argnames = { ‘mount_point fstype extr<br>a_options’, ‘extra_options’, ‘extra_options’ } (string list)<br>  info.interfaces = { ‘org.freedesktop.Hal.Device.Volume’ } (string list)<br>  storage.model = ‘’  (string)<br>  volume.size = 93340445184  (0x15bb862a00)  (uint64)<br>  info.udi = ‘/org/freedesktop/Hal/devices/volume_uuid_EE0454B90454868D’  (strin<br>g)<br>  volume.mount.valid_options = { ‘ro’, ‘sync’, ‘dirsync’, ‘noatime’, ‘nodiratime<br>‘, ‘noexec’, ‘quiet’, ‘remount’, ‘exec’, ‘uid=’, ‘gid=’, ‘umask=’, ‘dmask=’, ‘fm<br>ask=’, ‘locale=’, ‘utf8’ } (string list)<br>  org.freedesktop.Hal.Device.Volume.method_signatures = { ‘ssas’, ‘as’, ‘as’ } (string list)<br>  block.major = 8  (0x8)  (int)<br>  volume.fstype = ‘ntfs’  (string)<br>  org.freedesktop.Hal.Device.Volume.method_execpaths = { ‘hal-storage-mount’, ‘hal-storage-unmount’, ‘hal-storage-eject’ } (string list)<br>  volume.unmount.valid_options = { ‘lazy’ } (string list)<br>linux.hotplug_type = 3  (0x3)  (int)<br>  volume.partition.start = 62915198976  (0xea609c000)  (uint64)<br>  linux.sysfs_path = ‘/sys/block/sda/sda5’  (string)  </p>
<p>这里的全部都是关于hal自动挂载sda5的信息，上面的信息都是可以改动的。<br>现在我们要做的就是改动上面的信息，我们使用hal-set-property，来改变他们的值(这个命令需要root用户权限)。<br>通 常情况下使用这样的命令结构，hal-set-property –udi 设备的udi值（udi，相当于hal挂载设备的id是唯一的） –key 要改的键(如要改标卷volume.label) 然后接要改的值的类型 (–string 表示值为字符串, –int 值为整型，–bool 值为布尔) 后面为具体的值。<br>例如，我们要修改sda5的自动挂载的挂载点，让他固定而非disk-x，<br>hal-set-property –udi /org/freedesktop/Hal/devices/volume_uuid_EE0454B90454868D –key volume.mount_point –string /media/winE<br> hal-set-property –udi /org/freedesktop/Hal/devices/computer –key system.hardware.product –string “PowerEdge R610”<br>hal-set-property –udi /org/freedesktop/Hal/devices/computer –key system.hardware.serial –string “H5C3X3X”</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/03/07/fuxin-pdf-reader-v4-to-advertising-methods/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="haitian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="haitian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/03/07/fuxin-pdf-reader-v4-to-advertising-methods/" itemprop="url">福昕PDF阅读器 V4去广告方法</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-03-07T13:40:43+08:00">
                2011-03-07
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/默认分类/" itemprop="url" rel="index">
                    <span itemprop="name">默认分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><strong><em>清理历史痕迹的批处理</em></strong></p>
<p>将以下批处理内容（蓝色字体），复制到记事本，另存为，“清理Foxit PDF Reader历史痕迹.bat”即可。</p>
<p>（名字任意，不带双引号）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">----------------------------------华丽的分割线---------------------------------------------</span><br><span class="line"></span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">title清理Foxit PDF Reader历史痕迹</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo清理Foxit PDF Reader历史痕迹</span><br><span class="line"></span><br><span class="line">pause</span><br><span class="line"></span><br><span class="line">reg delete &quot;HKCU\\Software\\Foxit Software\\福昕阅读器\\Recent File List&quot; /f &gt;nul 2&gt;nul</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo清理完成</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo按任意键关闭</span><br><span class="line"></span><br><span class="line">pause&gt;nul</span><br><span class="line"></span><br><span class="line">exit</span><br><span class="line"></span><br><span class="line">--------------------------------华丽的分割线-----------------------------------------------</span><br></pre></td></tr></table></figure></p>
<p><strong><em>设置为不显示广告的批处理</em></strong></p>
<p>将以下批处理内容（绿色字体），复制到记事本，另存为，“不显示软件界面右上角的广告条.bat”即可。</p>
<p>（名字任意，不带双引号）<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br></pre></td><td class="code"><pre><span class="line">--------------------------------华丽的分割线-----------------------------------------------</span><br><span class="line"></span><br><span class="line">@echo off</span><br><span class="line"></span><br><span class="line">title不显示软件界面右上角的广告条</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo不显示软件界面右上角的广告条</span><br><span class="line"></span><br><span class="line">pause</span><br><span class="line"></span><br><span class="line">reg add &quot;HKCU\\Software\\Foxit Software\\福昕阅读器\\MainFrame&quot; /f /v ShowAd /t REG_SZ /d 0 &gt;nul 2&gt;nul</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo设置完成</span><br><span class="line"></span><br><span class="line">echo.</span><br><span class="line"></span><br><span class="line">echo按任意键关闭</span><br><span class="line"></span><br><span class="line">pause&gt;nul</span><br><span class="line"></span><br><span class="line">exit</span><br><span class="line"></span><br><span class="line">--------------------------------华丽的分割线-----------------------------------------------</span><br></pre></td></tr></table></figure></p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/03/03/nginx-s-nginx-http-push-module-module-test-2/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="haitian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="haitian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/03/03/nginx-s-nginx-http-push-module-module-test-2/" itemprop="url">Nginx的nginx_http_push_module模块测试</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-03-03T18:10:59+08:00">
                2011-03-03
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/默认分类/" itemprop="url" rel="index">
                    <span itemprop="name">默认分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://pushmodule.slact.net/" target="_blank" rel="noopener">Nginx的nginx_http_push_modul</a>e模块，可以使nginx服务器成为一个comet服务器</p>
<p>可以接受Client端的一个长连接请求，当server端有消息push时，则返回消息给Client</p>
<p>1. 编译很简单：</p>
<p>–add-module=../slact-nginx_http_push_module</p>
<p>2.配置如下：</p>
<p>折叠展开复制代码</p>
<ol>
<li>push_max_reserved_memory 20M;</li>
<li>push_authorized_channels_only on;</li>
<li></li>
<li><p>server{</p>
</li>
<li>listen 80;</li>
<li>server_name localhost test.ysz.com;</li>
<li>access_log /opt/work/log/nginx_access_ysz.log main;</li>
<li>error_log /opt/work/log/nginx_error_ysz.log error;</li>
<li></li>
<li><p>location /publish {</p>
</li>
<li>set $push_channel_id $arg_id;</li>
<li>push_publisher;</li>
<li>push_store_messages on;</li>
<li>push_message_timeout 2h;</li>
<li>push_max_message_buffer_length 10;</li>
<li>}</li>
<li>location /activity {</li>
<li>push_subscriber;</li>
<li>set \$push_channel_id \$arg_id;</li>
<li>push_subscriber_concurrency broadcast;</li>
<li>default_type text/plain;</li>
<li>}</li>
<li>}</li>
</ol>
<p>3.测试：</p>
<p>浏览器端访问<a href="http://localhost/activity?id=10000，则请求会被堵塞" target="_blank" rel="noopener">http://localhost/activity?id=10000，则请求会被堵塞</a></p>
<p>用python写一个简单的post程序，向<a href="http://localhost//publish?id=10000上post数据，则浏览器端会马上得到该消息" target="_blank" rel="noopener">http://localhost//publish?id=10000上post数据，则浏览器端会马上得到该消息</a></p>
<p>注意：请求publish时，如果要发布消息，则必须得是POST请求，而且对应的Content-Type会被转发给长连接的Client。Get请求会返回当前是否有存在的channel_id。具体的Http Push协议细节，可参考<a href="http://pushmodule.slact.net/protocol.html" target="_blank" rel="noopener">http://pushmodule.slact.net/protocol.html</a></p>
<p>4.一些问题：</p>
<ul>
<li>如果push模块放在后端的nginx上，而前段nginx反响代理到后端，当Client发送长连接请求时，<br>默认1分钟会直接断掉连接，返回504，不过可以设置proxy_read_timeout时间足够长来解决</li>
<li>设置push_subscriber_concurrency broadcast，可以将push消息同时发送给同一个用户开启的多个浏览器窗口，但我在一个浏览器里开多个tab也来请求，却只有一个能得到消息，另外一个请求仍旧没有返回。当设置成first时，对应同一个channel_id，如果有多个长连接请求，则只有第一个会等待返回，其它的都返回409。设置成last时，我的测试结果是所有请求都会断掉，似乎是一个Bug?</li>
<li>设置push_store_messages on，当没有对应的长连接请求时，可以暂时把msg缓存起来</li>
<li>设置push_authorized_channels_only on可以打开认证功能，只有当publisher给对应的<br>channel_id发送过消息后，Client端才可以发起一个长连接请求，否则会返回403 Forbidden错误</li>
<li>当client发起一个长连接请求时，accesslog和后端应用是无法知道其发送请求。不过，通过向publish发送一个Get请求来判断是否有对应channel_id的长连接请求.</li>
</ul>
<p>5.部分协议细节：</p>
<ul>
<li><p>订阅者：</p>
<p>The <a href="http://suchalin.blog.163.com/blog/#term-server" target="_blank" rel="noopener">server</a> MUST accept all valid HTTP <code>GET</code> requests to the <a href="http://suchalin.blog.163.com/blog/#term-subscriber" target="_blank" rel="noopener">subscriber</a> <a href="http://suchalin.blog.163.com/blog/#term-location" target="_blank" rel="noopener">location</a>. All other request methods SHOULD be responded to with a <code>405 Method Not Allowed</code>status code.  </p>
<p>Subscriber requests are considered notifications of intent to receive some message. Subscribers may request existing messages, messages that are not yet available, and messages that are no longer available. The requested message is identified using the <code>If-Modified-Since</code> and <code>If-None-Match</code> request headers. A request with no <code>If-Modified-Since</code> header MUST be assumed to be requesting the oldest available message in a channel. Each <code>200 OK</code> response containing a message MUST have its<code>Last-Modified</code> and <code>Etag</code> headers set so that a request using those headers will be interpreted as a request for the next available message. Additionally, said <code>200 OK</code>MUST contain the <code>Content-Type</code> header of the message publisher request, unless no <code>Content-Type</code> header had been provided or it is explicitly overridden by server configuration.</p>
<p>There are several common mechanisms for performing an HTTP server push. The rest of the behavior of the server in response to a subscriber request SHOULD be configurable and MUST be selected from the following list of mechanisms:</p>
<p>Long-Polling</p>
<p>Requests for existing messages will be responded to immediately; responses to requests for messages not yet available MUST be delayed until the message becomes available. Delayed responses MUST satisfy all of the following conditions:  </p>
<ul>
<li>A <code>200 OK</code> response containing the message (and its <code>Content-Type</code>) MUST be sent immediately after the message becomes available<br>. The entire response must be indistinguishable from a response to a request for an existing message.</li>
<li>If the channel the subscriber is waiting on is deleted or for some reason becomes unavailable, the server MUST immediately send a <code>410 Gone</code> response.</li>
<li>If another subscriber has conflicted with this request, the server MUST immediately send a <code>409 Conflict</code> response.</li>
</ul>
<p>Interval-Polling</p>
<p>All requests will be responded to immediately. Requests for messages not yet available MUST produce a <code>304 Not Modified</code> response code.</p>
<p>In addition, when the server receives more than one concurrent subscriber request on the same channel, it MUST do one of the following:</p>
<p>Broadcast</p>
<p>No additional actions are performed</p>
<p>Last-in, first-out</p>
<p>All but the most recent long-held <a href="http://suchalin.blog.163.com/blog/#term-subscriber" target="_blank" rel="noopener">subscriber</a> request on the channel are sent a <code>409 Conflict</code> response.</p>
<p>First-in, last-out</p>
<p>All but the oldest request will be sent a <code>409 Conflict</code></p>
</li>
</ul>
<pre><code>The [server](http://suchalin.blog.163.com/blog/#term-server) SHOULD make this selection configurable, and MUST default to `broadcast` behavior.
</code></pre><ul>
<li>发送者：</li>
</ul>
<pre><code>The [server](http://suchalin.blog.163.com/blog/#term-server) MUST accept all valid HTTP requests to the publisher [location](http://suchalin.blog.163.com/blog/#term-location). The [server](http://suchalin.blog.163.com/blog/#term-server), when sent a publisher request, MUST satisfy all of the following conditions:  

*   GET requests receive a `200 OK` response for existing [channels](http://suchalin.blog.163.com/blog/#term-channel) and a `404 Not Found` otherwise. &lt; /li&gt;
*   PUT requests receive a `200 OK` response. The request creates a [channel](http://suchalin.blog.163.com/blog/#term-channel) if no [channel](http://suchalin.blog.163.com/blog/#term-channel) with the given [channel id](http://suchalin.blog.163.com/blog/#term-channel_id) exists.
*   DELETE requests receive a `200 OK` if the [channel](http://suchalin.blog.163.com/blog/#term-channel) identified by the [channel id](http://suchalin.blog.163.com/blog/#term-channel_id) exists and has been completely deleted. All [subscribers](http://suchalin.blog.163.com/blog/#term-subscriber) MUST have been sent a`410 Gone` response. Requests for nonexistent [channels](http://suchalin.blog.163.com/blog/#term-channel) MUST be responded to with a `404 Not Found`.
*   POST requests are used to send [messages](http://suchalin.blog.163.com/blog/#term-message). The request MAY contain a body in any encoding representing a [message](http://suchalin.blog.163.com/blog/#term-message) to be sent over the [channel](http://suchalin.blog.163.com/blog/#term-channel). The[message](http://suchalin.blog.163.com/blog/#term-message) MUST be immediately delivered to all currently long-held [subscriber](http://suchalin.blog.163.com/blog/#term-subscriber) requests. Additionally, the [message](http://suchalin.blog.163.com/blog/#term-message) MAY be stored for future retrieval and the oldest [message](http://suchalin.blog.163.com/blog/#term-message) stored for the [channel](http://suchalin.blog.163.com/blog/#term-channel) MAY be deleted.

    A POST request MUST be replied to with a `201 Created` if there were any long-held [subscribers](http://suchalin.blog.163.com/blog/#term-subscriber) that have been sent this [message](http://suchalin.blog.163.com/blog/#term-message), and with a `202 Accepted`otherwise.

    The Content-Type header of the request MUST be forwarded with the [message](http://suchalin.blog.163.com/blog/#term-message).
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/03/01/nginx-s-nginx-http-push-module-module-test/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="haitian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="haitian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/03/01/nginx-s-nginx-http-push-module-module-test/" itemprop="url">Nginx的nginx_http_push_module模块测试</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-03-01T14:27:39+08:00">
                2011-03-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/默认分类/" itemprop="url" rel="index">
                    <span itemprop="name">默认分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p><a href="http://pushmodule.slact.net/" target="_blank" rel="noopener">Nginx的nginx_http_push_modul</a>e模块，可以使nginx服务器成为一个comet服务器</p>
<p>可以接受Client端的一个长连接请求，当server端有消息push时，则返回消息给Client</p>
<p>1. 编译很简单：</p>
<p>–add-module=../slact-nginx_http_push_module</p>
<p>2.配置如下：</p>
<p>折叠展开复制代码</p>
<ol>
<li>push_max_reserved_memory 20M;</li>
<li>push_authorized_channels_only on;</li>
<li></li>
<li><p>server{</p>
</li>
<li>listen 80;</li>
<li>server_name localhost test.ysz.com;</li>
<li>access_log /opt/work/log/nginx_access_ysz.log main;</li>
<li>error_log /opt/work/log/nginx_error_ysz.log error;</li>
<li></li>
<li><p>location /publish {</p>
</li>
<li>set $push_channel_id $arg_id;</li>
<li>push_publisher;</li>
<li>push_store_messages on;</li>
<li>push_message_timeout 2h;</li>
<li>push_max_message_buffer_length 10;</li>
<li>}</li>
<li>location /activity {</li>
<li>push_subscriber;</li>
<li>set $push_channel_id $arg_id;</li>
<li>push_subscriber_concurrency broadcast;</li>
<li>default_type text/plain;</li>
<li>}</li>
<li>}</li>
</ol>
<p>3.测试：</p>
<p>浏览器端访问<a href="http://localhost/activity?id=10000，则请求会被堵塞" target="_blank" rel="noopener">http://localhost/activity?id=10000，则请求会被堵塞</a></p>
<p>用python写一个简单的post程序，向<a href="http://localhost//publish?id=10000上post数据，则浏览器端会马上得到该消息" target="_blank" rel="noopener">http://localhost//publish?id=10000上post数据，则浏览器端会马上得到该消息</a></p>
<p>注意：请求publish时，如果要发布消息，则必须得是POST请求，而且对应的Content-Type会被转发给长连接的Client。Get请求会返回当前是否有存在的channel_id。具体的Http Push协议细节，可参考<a href="http://pushmodule.slact.net/protocol.html" target="_blank" rel="noopener">http://pushmodule.slact.net/protocol.html</a></p>
<p>4.一些问题：</p>
<ul>
<li>如果push模块放在后端的nginx上，而前段nginx反响代理到后端，当Client发送长连接请求时，<br>默认1分钟会直接断掉连接，返回504，不过可以设置proxy_read_timeout时间足够长来解决</li>
<li>设置push_subscriber_concurrency broadcast，可以将push消息同时发送给同一个用户开启的多个浏览器窗口，但我在一个浏览器里开多个tab也来请求，却只有一个能得到消息，另外一个请求仍旧没有返回。当设置成first时，对应同一个channel_id，如果有多个长连接请求，则只有第一个会等待返回，其它的都返回409。设置成last时，我的测试结果是所有请求都会断掉，似乎是一个Bug?</li>
<li>设置push_store_messages on，当没有对应的长连接请求时，可以暂时把msg缓存起来</li>
<li>设置push_authorized_channels_only on可以打开认证功能，只有当publisher给对应的<br>channel_id发送过消息后，Client端才可以发起一个长连接请求，否则会返回403 Forbidden错误</li>
<li>当client发起一个长连接请求时，accesslog和后端应用是无法知道其发送请求。不过，通过向publish发送一个Get请求来判断是否有对应channel_id的长连接请求.</li>
</ul>
<p>5.部分协议细节：</p>
<ul>
<li><p>订阅者：</p>
<p>The <a href="http://suchalin.blog.163.com/blog/#term-server" target="_blank" rel="noopener">server</a> MUST accept all valid HTTP <code>GET</code> requests to the <a href="http://suchalin.blog.163.com/blog/#term-subscriber" target="_blank" rel="noopener">subscriber</a> <a href="http://suchalin.blog.163.com/blog/#term-location" target="_blank" rel="noopener">location</a>. All other request methods SHOULD be responded to with a <code>405 Method Not Allowed</code>status code.  </p>
<p>Subscriber requests are considered notifications of intent to receive some message. Subscribers may request existing messages, messages that are not yet available, and messages that are no longer available. The requested message is identified using the <code>If-Modified-Since</code> and <code>If-None-Match</code> request headers. A request with no <code>If-Modified-Since</code> header MUST be assumed to be requesting the oldest available message in a channel. Each <code>200 OK</code> response containing a message MUST have its<code>Last-Modified</code> and <code>Etag</code> headers set so that a request using those headers will be interpreted as a request for the next available message. Additionally, said <code>200 OK</code>MUST contain the <code>Content-Type</code> header of the message publisher request, unless no <code>Content-Type</code> header had been provided or it is explicitly overridden by server configuration.</p>
<p>There are several common mechanisms for performing an HTTP server push. The rest of the behavior of the server in response to a subscriber request SHOULD be configurable and MUST be selected from the following list of mechanisms:</p>
<p>Long-Polling</p>
<p>Requests for existing messages will be responded to immediately; responses to requests for messages not yet available MUST be delayed until the message becomes available. Delayed responses MUST satisfy all of the following conditions:  </p>
<ul>
<li>A <code>200 OK</code> response containing the message (and its <code>Content-Type</code>) MUST be sent immediately after the message becomes available<br>. The entire response must be indistinguishable from a response to a request for an existing message.</li>
<li>If the channel the subscriber is waiting on is deleted or for some reason becomes unavailable, the server MUST immediately send a <code>410 Gone</code> response.</li>
<li>If another subscriber has conflicted with this request, the server MUST immediately send a <code>409 Conflict</code> response.</li>
</ul>
<p>Interval-Polling</p>
<p>All requests will be responded to immediately. Requests for messages not yet available MUST produce a <code>304 Not Modified</code> response code.</p>
<p>In addition, when the server receives more than one concurrent subscriber request on the same channel, it MUST do one of the following:</p>
<p>Broadcast</p>
<p>No additional actions are performed</p>
<p>Last-in, first-out</p>
<p>All but the most recent long-held <a href="http://suchalin.blog.163.com/blog/#term-subscriber" target="_blank" rel="noopener">subscriber</a> request on the channel are sent a <code>409 Conflict</code> response.</p>
<p>First-in, last-out</p>
<p>All but the oldest request will be sent a <code>409 Conflict</code></p>
</li>
</ul>
<pre><code>The [server](http://suchalin.blog.163.com/blog/#term-server) SHOULD make this selection configurable, and MUST default to `broadcast` behavior.
</code></pre><ul>
<li>发送者：</li>
</ul>
<pre><code>The [server](http://suchalin.blog.163.com/blog/#term-server) MUST accept all valid HTTP requests to the publisher [location](http://suchalin.blog.163.com/blog/#term-location). The [server](http://suchalin.blog.163.com/blog/#term-server), when sent a publisher request, MUST satisfy all of the following conditions:  

*   GET requests receive a `200 OK` response for existing [channels](http://suchalin.blog.163.com/blog/#term-channel) and a `404 Not Found` otherwise. &lt; /li&gt;
*   PUT requests receive a `200 OK` response. The request creates a [channel](http://suchalin.blog.163.com/blog/#term-channel) if no [channel](http://suchalin.blog.163.com/blog/#term-channel) with the given [channel id](http://suchalin.blog.163.com/blog/#term-channel_id) exists.
*   DELETE requests receive a `200 OK` if the [channel](http://suchalin.blog.163.com/blog/#term-channel) identified by the [channel id](http://suchalin.blog.163.com/blog/#term-channel_id) exists and has been completely deleted. All [subscribers](http://suchalin.blog.163.com/blog/#term-subscriber) MUST have been sent a`410 Gone` response. Requests for nonexistent [channels](http://suchalin.blog.163.com/blog/#term-channel) MUST be responded to with a `404 Not Found`.
*   POST requests are used to send [messages](http://suchalin.blog.163.com/blog/#term-message). The request MAY contain a body in any encoding representing a [message](http://suchalin.blog.163.com/blog/#term-message) to be sent over the [channel](http://suchalin.blog.163.com/blog/#term-channel). The[message](http://suchalin.blog.163.com/blog/#term-message) MUST be immediately delivered to all currently long-held [subscriber](http://suchalin.blog.163.com/blog/#term-subscriber) requests. Additionally, the [message](http://suchalin.blog.163.com/blog/#term-message) MAY be stored for future retrieval and the oldest [message](http://suchalin.blog.163.com/blog/#term-message) stored for the [channel](http://suchalin.blog.163.com/blog/#term-channel) MAY be deleted.

    A POST request MUST be replied to with a `201 Created` if there were any long-held [subscribers](http://suchalin.blog.163.com/blog/#term-subscriber) that have been sent this [message](http://suchalin.blog.163.com/blog/#term-message), and with a `202 Accepted`otherwise.

    The Content-Type header of the request MUST be forwarded with the [message](http://suchalin.blog.163.com/blog/#term-message).
</code></pre>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/03/01/bash-shell-program-design-while-read-encounters-ssh/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="haitian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="haitian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/03/01/bash-shell-program-design-while-read-encounters-ssh/" itemprop="url">[Bash Shell 程序设计]当while read 遇上ssh</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-03-01T10:18:26+08:00">
                2011-03-01
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/默认分类/" itemprop="url" rel="index">
                    <span itemprop="name">默认分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>先看一段简化过的BASH SHELL代码<br><figure class="highlight plain"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br></pre></td><td class="code"><pre><span class="line">TODAY=\`date +%Y%m%d\`  </span><br><span class="line">SUFFIX=&quot;tar&quot;  </span><br><span class="line">CONF=the\_config\_file  </span><br><span class="line">i=0  </span><br><span class="line"></span><br><span class="line">while read HOST SRCPATH DSTPATH  </span><br><span class="line">do  </span><br><span class="line">        (( i++ ))  </span><br><span class="line">        if [ &quot;X$&#123;HOST:0:1&#125;&quot; = &quot;X#&quot; -o $&#123;#DSTPATH&#125; -eq 0 ]  </span><br><span class="line">        then  </span><br><span class="line">                #忽略注释行及少于3个项的记录  </span><br><span class="line">        else ssh $&#123;HOST&#125; &quot;tar c $&#123;SRCPATH&#125;&quot; &gt;$&#123;DSTPATH&#125;.$&#123;TODAY&#125;.$&#123;SUFFIX&#125; 2&gt;/dev/null  </span><br><span class="line">        fi  </span><br><span class="line">done &lt; $CONF</span><br></pre></td></tr></table></figure></p>
<p>作者的本意是通过脚本读取配置文件\$CONF，然后打包备份\$CONF中指定的文件，但执行后发现程序在成功备份\$CONF中指定的第一个文件后即退出……  </p>
<p>跟踪后发现read在备份完第一个文件后就再读不到任何数据，所以while循环结束－－也就是说，<br>通过重定向$CONF文件传给标准输入的数据被  </p>
<p>ssh \${HOST} “tar c \${SRCPATH}” &gt;\${DSTPATH}.\${TODAY}.${SUFFIX} 2&gt;/dev/null  </p>
<p>这个命令提前吃掉了。  </p>
<p>将其改为<br>ssh \${HOST} “tar c \${SRCPATH}” &gt;\${DSTPATH}.\${TODAY}.${SUFFIX} 2&gt;/dev/null &lt;/dev/null  </p>
<p>将ssh的标准输入重定向到/dev/null，程序正常备份所有$CONF中指定的文件。  </p>
<hr>
<p>结论:  </p>
<p>while read时，要注意那些处理标准输入的命令，例如  </p>
<p>cat,mail,ssh,grep,sed,tr,awk……（几乎所有支持流文本处理的命令都包含在内)</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/02/25/linux-network-card-set-up-gigabit-network-speed-and-mode/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="haitian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="haitian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/02/25/linux-network-card-set-up-gigabit-network-speed-and-mode/" itemprop="url">LINUX网卡(设置千兆网卡速度及模式)</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-02-25T17:26:57+08:00">
                2011-02-25
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/默认分类/" itemprop="url" rel="index">
                    <span itemprop="name">默认分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>Ethtool是用于查询及设置网卡参数的命令。<br>概要：<br>ethtool ethX      //查询ethX网口基本设置<br>ethtool –h        //显示ethtool的命令帮助(help)<br>ethtool –i ethX    //查询ethX网口的相关信息<br>ethtool –d ethX    //查询ethX网口注册性信息<br>ethtool –r ethX    //重置ethX网口到自适应模式<br>ethtool –S ethX    //查询ethX网口收发包统计<br>ethtool –s ethX [speed 10|100|1000]\         //设置网口速率10/100/1000M<br>[duplex half|full]\           //设置网口半/全双工<br>[autoneg on|off]\            //设置网口是否自协商<br>[port tp|aui|bnc|mii]\         //设置网口类型<br>[phyad N]\<br>[xcvr internal|exteral]\<br>[wol p|u|m|b|a|g|s|d…]\<br>[sopass xx:yy:zz:aa:bb:cc]\<br>[msglvl N]</p>
<p>举例：<br>1）[root@linux /]# ethtool eth1<br>   Settings for eth1:<br>        Supported ports: [ TP ]<br>        Supported link modes:   10baseT/Half 10baseT/Full<br>                                100baseT/Half 100baseT/Full<br>                                1000baseT/Full<br>        Supports auto-negotiation: Yes<br>        Advertised link modes:  10baseT/Half 10baseT/Full<br>                                100baseT/Half 100baseT/Full<br>                                1000baseT/Full<br>        Advertised auto-negotiation: Yes<br>        Speed: 1000Mb/s<br>        Duplex: Full<br>        Port: Twisted Pair<br>        PHYAD: 0<br>        Transceiver: internal<br>        Auto-negotiation: on<br>        Supports Wake-on: umbg<br>        Wake-on: d<br>        Link detected: yes<br>2）[root@linux /]# ethtool -i eth1<br>   driver: e1000<br>   version: 5.0.43-k1<br>   firmware-version: N/A<br>   bus-info: 06:08.1<br>3）[root@linux /]# ethtool -S eth1<br>   NIC statistics:<br>     rx_packets: 58068300<br>     tx_packets: 87124083<br>     rx_bytes: 1589713008<br>     tx_bytes: 2165825901<br>     rx_errors: 0<br>     tx_errors: 0<br>     rx_dropped: 0<br>     tx_dropped: 0<br>     multicast: 0<br>     collisions: 0<br>     rx_length_errors: 0<br>     rx_over_errors: 0<br>     rx_crc_errors: 0<br>     rx_frame_errors: 0<br>     rx_fifo_errors: 0<br>     rx_missed_errors: 0<br>     tx_aborted_errors: 0<br>     tx_carrier_errors: 0<br>     tx_fifo_errors: 0<br>     tx_heartbeat_errors: 0<br>     tx_window_errors: 0<br>4）[root@linux /]# ethtool -s eth1 autoneg off speed 100 duplex full</p>
<p>相关：<br>1）[root@linux /]# which ethtool<br>    /sbin/ethtool<br>2）[root@linux /]# rpm -qf /sbin/ethtool<br>   ethtool-1.6-5<br>3）怎样使ethtool设置永久保存在网络设备中？<br>   解决方法一:<br>    ethtool设置可通过/etc/sysconfig/network-scripts/ifcfg-ethX文件保存,从而在设备下次启动时激活选项。<br>例如：ethtool -s eth0 speed 100 duplex full autoneg off<br>此指令将eth0设备设置为全双工自适应，速度为100Mbs。若要eth0启动时设置这些参数, 修改文件/etc/sysconfig/network-scripts/ifcfg-eth0 ，添加如下一行:<br> ETHTOOL_OPTS=”speed 100 duplex full autoneg off”<br>解决方法二:<br>将ethtool设置写入/etc/rc.d/rc.local之中。</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/01/27/happiness/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="haitian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="haitian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/01/27/happiness/" itemprop="url">幸福</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-01-27T14:20:45+08:00">
                2011-01-27
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/默认分类/" itemprop="url" rel="index">
                    <span itemprop="name">默认分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>小猪问妈妈幸福在哪里，妈妈说幸福就在自己的尾巴上。于是小猪开始用嘴咬它的小尾巴，却总也咬不到，它沮丧地告诉妈妈自己抓不住幸福，妈妈笑笑说：“孩子，只要你一直往前走，幸福就会一直跟着你……”</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/01/20/about-money/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="haitian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="haitian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/01/20/about-money/" itemprop="url">关于金钱</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-01-20T13:34:25+08:00">
                2011-01-20
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/默认分类/" itemprop="url" rel="index">
                    <span itemprop="name">默认分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>有了钱  </p>
<p>你可以买楼  </p>
<p>但不可以买到一个家<br>有了钱  </p>
<p>你可以买钟表  </p>
<p>但不可以买到时间<br>有了钱  </p>
<p>你可以买一张床  </p>
<p>但不可以买到充足的睡眠<br>有了钱  </p>
<p>你可以买书  </p>
<p>但不可以买到知识<br>有了钱  </p>
<p>你可以买到医疗服务  </p>
<p>但不可以买到健康<br>有了钱  </p>
<p>你可以买到地位  </p>
<p>但不可以买到尊重<br>有了钱  </p>
<p>你可以买到血液  </p>
<p>但不可以买到生命<br>有了钱  </p>
<p>你可以买性  </p>
<p>但不可以买到爱</p>

          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
      

  

  
  
  

  <article class="post post-type-normal" itemscope itemtype="http://schema.org/Article">
  
  
  
  <div class="post-block">
    <link itemprop="mainEntityOfPage" href="http://yoursite.com/2011/01/19/nginx-upon-jjs-route-plug-in-is-forwarded-by-sessionid/">

    <span hidden itemprop="author" itemscope itemtype="http://schema.org/Person">
      <meta itemprop="name" content="haitian">
      <meta itemprop="description" content="">
      <meta itemprop="image" content="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5">
    </span>

    <span hidden itemprop="publisher" itemscope itemtype="http://schema.org/Organization">
      <meta itemprop="name" content="haitian的博客">
    </span>

    
      <header class="post-header">

        
        
          <h1 class="post-title" itemprop="name headline">
                
                <a class="post-title-link" href="/2011/01/19/nginx-upon-jjs-route-plug-in-is-forwarded-by-sessionid/" itemprop="url">nginx-upstream-jvm-route插件 按sessionid转发</a></h1>
        

        <div class="post-meta">
          <span class="post-time">
            
              <span class="post-meta-item-icon">
                <i class="fa fa-calendar-o"></i>
              </span>
              
                <span class="post-meta-item-text">发表于</span>
              
              <time title="创建于" itemprop="dateCreated datePublished" datetime="2011-01-19T18:39:50+08:00">
                2011-01-19
              </time>
            

            

            
          </span>

          
            <span class="post-category" >
            
              <span class="post-meta-divider">|</span>
            
              <span class="post-meta-item-icon">
                <i class="fa fa-folder-o"></i>
              </span>
              
                <span class="post-meta-item-text">分类于</span>
              
              
                <span itemprop="about" itemscope itemtype="http://schema.org/Thing">
                  <a href="/categories/默认分类/" itemprop="url" rel="index">
                    <span itemprop="name">默认分类</span>
                  </a>
                </span>

                
                
              
            </span>
          

          
            
          

          
          

          

          

          

        </div>
      </header>
    

    
    
    
    <div class="post-body" itemprop="articleBody">

      
      

      
        
          
            <p>1–安装nginx-0.7.65<br>1-0 下载包<br>jvm-route安装包下载命令：<br>svn checkout <a href="http://nginx-upstream-jvm-route.googlecode.com/svn/trunk/" target="_blank" rel="noopener">http://nginx-upstream-jvm-route.googlecode.com/svn/trunk/</a> nginx-upstream-jvm-route-read-only</p>
<p>nginx当前稳定版下载路径<br>wget  <a href="http://nginx.org/download/nginx-0.7.65.tar.gz" target="_blank" rel="noopener">http://nginx.org/download/nginx-0.7.65.tar.gz</a></p>
<p>1-1 解压缩 nginx-0.7.65.tar.gz 到 /usr/develop/yagnwr<br>1-2 解压缩 jvm-route.zip 到/usr/develop/yagnwr<br> 还可以从 网站上下载svn checkout <a href="http://nginx-upstream-jvm-route.googlecode.com/svn/trunk/" target="_blank" rel="noopener">http://nginx-upstream-jvm-route.googlecode.com/svn/trunk/</a> nginx-upstream-jvm-route-read-only<br>1-3 切换到 /usr/develop/yagnwr/nginx-0.7.65<br>1-4 patch -p0 &lt; /usr/develop/yagnwr/jvm-route/jvm_route.patch<br>1-5 ./configure –prefix=/usr/mpsp/nginx-0.7.65  –add-module=/home/yangwr/soft/jvm-route/  –with-http_stub_status_module<br>1-6 make<br>1-7 make install</p>
<p>2–配置文件<br>rm -f /usr/mpsp/nginx-0.7.65/nginx.conf<br>vi /usr/mpsp/nginx-0.7.65/nginx.conf</p>
<p>3–修改nginx.conf–针对tomcat<br> 服务器10.110.5.151上的nginx.conf负载做如下配置<br> upstream newjboss {  </p>
<pre><code>   #ip_hash;  
   server 10.110.5.151:9081    srun_id=a;  
   server 10.110.5.152:9081     srun_id=b;  
   jvm\_route $cookie\_JSESSIONID|sessionid reverse;  
}  
</code></pre><p>  4–修改tomcat配置/tomcat/conf/server.xml<br>10.110.5.151修改为  </p>
<engine name="Catalina" defaulthost="localhost" jvmroute="a">

<p>10.110.5.152修改为  </p>
<engine name="Catalina" defaulthost="localhost" jvmroute="b">
</engine></engine>
          
        
      
    </div>
    
    
    

    

    

    

    <footer class="post-footer">
      

      

      

      
      
        <div class="post-eof"></div>
      
    </footer>
  </div>
  
  
  
  </article>


    
  </section>

  
  <nav class="pagination">
    <a class="extend prev" rel="prev" href="/page/5/"><i class="fa fa-angle-left"></i></a><a class="page-number" href="/">1</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><span class="page-number current">6</span><a class="page-number" href="/page/7/">7</a><span class="space">&hellip;</span><a class="page-number" href="/page/28/">28</a><a class="extend next" rel="next" href="/page/7/"><i class="fa fa-angle-right"></i></a>
  </nav>



          </div>
          


          

        </div>
        
          
  
  <div class="sidebar-toggle">
    <div class="sidebar-toggle-line-wrap">
      <span class="sidebar-toggle-line sidebar-toggle-line-first"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-middle"></span>
      <span class="sidebar-toggle-line sidebar-toggle-line-last"></span>
    </div>
  </div>

  <aside id="sidebar" class="sidebar">
    
    <div class="sidebar-inner">

      

      

      <section class="site-overview-wrap sidebar-panel sidebar-panel-active">
        <div class="site-overview">
          <div class="site-author motion-element" itemprop="author" itemscope itemtype="http://schema.org/Person">
            
              <img class="site-author-image" itemprop="image"
                src="http://q1.qlogo.cn/g?b=qq&nk=493654134&s=5"
                alt="haitian" />
            
              <p class="site-author-name" itemprop="name">haitian</p>
              <p class="site-description motion-element" itemprop="description"></p>
          </div>

          <nav class="site-state motion-element">

            
              <div class="site-state-item site-state-posts">
              
                <a href="/archives/">
              
                  <span class="site-state-item-count">278</span>
                  <span class="site-state-item-name">日志</span>
                </a>
              </div>
            

            
              
              
              <div class="site-state-item site-state-categories">
                
                  <span class="site-state-item-count">10</span>
                  <span class="site-state-item-name">分类</span>
                
              </div>
            

            
              
              
              <div class="site-state-item site-state-tags">
                
                  <span class="site-state-item-count">164</span>
                  <span class="site-state-item-name">标签</span>
                
              </div>
            

          </nav>

          

          

          
          

          
          

          

        </div>
      </section>

      

      

    </div>
  </aside>


        
      </div>
    </main>

    <footer id="footer" class="footer">
      <div class="footer-inner">
        <div class="copyright">&copy; <span itemprop="copyrightYear">2018</span>
  <span class="with-love">
    <i class="fa fa-user"></i>
  </span>
  <span class="author" itemprop="copyrightHolder">haitian</span>

  
</div>


  <div class="powered-by">由 <a class="theme-link" target="_blank" href="https://hexo.io">Hexo</a> 强力驱动</div>



  <span class="post-meta-divider">|</span>



  <div class="theme-info">主题 &mdash; <a class="theme-link" target="_blank" href="https://github.com/iissnan/hexo-theme-next">NexT.Mist</a> v5.1.4</div>




        







        
      </div>
    </footer>

    
      <div class="back-to-top">
        <i class="fa fa-arrow-up"></i>
        
      </div>
    

    

  </div>

  

<script type="text/javascript">
  if (Object.prototype.toString.call(window.Promise) !== '[object Function]') {
    window.Promise = null;
  }
</script>









  












  
  
    <script type="text/javascript" src="/lib/jquery/index.js?v=2.1.3"></script>
  

  
  
    <script type="text/javascript" src="/lib/fastclick/lib/fastclick.min.js?v=1.0.6"></script>
  

  
  
    <script type="text/javascript" src="/lib/jquery_lazyload/jquery.lazyload.js?v=1.9.7"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/velocity/velocity.ui.min.js?v=1.2.1"></script>
  

  
  
    <script type="text/javascript" src="/lib/fancybox/source/jquery.fancybox.pack.js?v=2.1.5"></script>
  


  


  <script type="text/javascript" src="/js/src/utils.js?v=5.1.4"></script>

  <script type="text/javascript" src="/js/src/motion.js?v=5.1.4"></script>



  
  

  

  


  <script type="text/javascript" src="/js/src/bootstrap.js?v=5.1.4"></script>



  


  




	





  





  












  





  

  

  

  
  

  

  

  

</body>
</html>
